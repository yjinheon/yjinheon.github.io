<!DOCTYPE html>
<html lang="en">
<head><!-- hexo injector head_begin start --><link href="/css/hexo-widget-tree.css" rel="stylesheet"/><!-- hexo injector head_begin end -->
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" integrity="sha256-/4UQcSmErDzPCMAiuOiWPVVsNN2s3ZY/NsmXNcj0IFc=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"yjinheon.github.io","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.15.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="my blog">
<meta property="og:type" content="website">
<meta property="og:title" content="DataMind">
<meta property="og:url" content="https://yjinheon.github.io/blog/page/8/index.html">
<meta property="og:site_name" content="DataMind">
<meta property="og:description" content="my blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="JinHeon Yoon">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://yjinheon.github.io/blog/page/8/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"blog/page/8/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>DataMind</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/rss2.xml" title="DataMind" type="application/rss+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">DataMind</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="JinHeon Yoon"
      src="/images/medium.jpg">
  <p class="site-author-name" itemprop="name">JinHeon Yoon</p>
  <div class="site-description" itemprop="description">my blog</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">103</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">36</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">53</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/yjinheon" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yjinheon" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:yjinheon@gmail.com" title="E-Mail → mailto:yjinheon@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/ko" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yjinheon.github.io/2023/10/28/machine-learning/notebook/machine-learning/3_bias_variance/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/medium.jpg">
      <meta itemprop="name" content="JinHeon Yoon">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DataMind">
      <meta itemprop="description" content="my blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | DataMind">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/10/28/machine-learning/notebook/machine-learning/3_bias_variance/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-10-28 00:53:30" itemprop="dateCreated datePublished" datetime="2023-10-28T00:53:30+09:00">2023-10-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-02-27 19:08:09" itemprop="dateModified" datetime="2023-02-27T19:08:09+09:00">2023-02-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/" itemprop="url" rel="index"><span itemprop="name">machine-learning</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/notebook/" itemprop="url" rel="index"><span itemprop="name">notebook</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/notebook/machine-learning/" itemprop="url" rel="index"><span itemprop="name">machine-learning</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>lo</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yjinheon.github.io/2023/10/28/machine-learning/notebook/machine-learning/3_distance_based_model/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/medium.jpg">
      <meta itemprop="name" content="JinHeon Yoon">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DataMind">
      <meta itemprop="description" content="my blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | DataMind">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/10/28/machine-learning/notebook/machine-learning/3_distance_based_model/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-10-28 00:53:30" itemprop="dateCreated datePublished" datetime="2023-10-28T00:53:30+09:00">2023-10-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-02-27 19:08:09" itemprop="dateModified" datetime="2023-02-27T19:08:09+09:00">2023-02-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/" itemprop="url" rel="index"><span itemprop="name">machine-learning</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/notebook/" itemprop="url" rel="index"><span itemprop="name">notebook</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/notebook/machine-learning/" itemprop="url" rel="index"><span itemprop="name">machine-learning</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="KNN"><a href="#KNN" class="headerlink" title="KNN"></a>KNN</h2><p><strong>KNN</strong></p>
<ul>
<li><p>새로운 데이터에 대해 기존 데이터 가운데 가장 가까운 K개 이웃의 정보로 새로운 데이터를 예측하는 방법론.</p>
</li>
<li><p>회귀문제와 분류문제 해결에 모두 사용되는 지도학습</p>
</li>
<li><p>하이퍼파라미터는 기본적으로 거리측정방법과 탐색할 이웃 수 2가지 이다.</p>
</li>
<li><p><strong>K(이웃)을 적게 사용하면 모델 복잡도가 높아지고 많이 사용하면 복잡도가 낮아진다(K의 수를 늘릴수록 결정경계가 부드러워진다.).</strong></p>
</li>
<li><p>KNN은 회귀분석에도 쓰이며 여러개의 K를 사용할 경우 이웃들의 종속변수의 평균이 예측된다.</p>
</li>
<li><p>거리측정방법</p>
<ul>
<li>유클리디안 거리 : 데이터포인트 사이 직선 최단거리</li>
<li>마할라노비스 거리 : 공분산을 고려해 거리를 계산한다. 변수간 상관관계를 고려한 거리지표.</li>
<li>맨해튼 거리 : 각 좌표축 방향으로만 이동할 경우 계산된다. 격자모양의 길을 따라간다.</li>
</ul>
</li>
<li><p>주의점</p>
<ul>
<li>기본적으로 거리기반이기 때문에 KNN을 돌리기 전 반드시 변수를 정규화 해야 한다.</li>
<li>불균형 데이터의 분류문제를 풀 경우 학습데이터 범주의 사전확률(Prior Probability)를 고려해야핟다.</li>
</ul>
</li>
<li><p>장단점</p>
<ul>
<li>장점 : 학습 데이터 내 노이즈의 영향들 덜받음. 학습데이터가 많으면 효과적 </li>
<li>단점 : 어떤 거리척도가 분석에 적랍한지 불분명. 계산시간이 오래 걸림</li>
</ul>
</li>
</ul>
<h3 id="구현"><a href="#구현" class="headerlink" title="구현"></a>구현</h3><ul>
<li>유클라디안 거리를 활용한 KNN 구현</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">euclidean_distance</span>(<span class="params">x1,x2</span>):</span><br><span class="line">    <span class="keyword">return</span> np.sqrt(np.<span class="built_in">sum</span>((x1-x2)**<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">KNN</span>:</span><br><span class="line"></span><br><span class="line">    self __init__(self, k=<span class="number">3</span>):</span><br><span class="line">        self.k = k </span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">fit</span>(<span class="params">self, X, y</span>): <span class="comment"># triain sample and label</span></span><br><span class="line">        self.X_train = X</span><br><span class="line">        self.y_train = y</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">predict</span>(<span class="params">self, X</span>):</span><br><span class="line">        predicted_labels = [self._predict(x) <span class="keyword">for</span> x <span class="keyword">in</span> X]</span><br><span class="line">        <span class="keyword">return</span> np.array</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_predict</span>(<span class="params">self,x</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        1. 거리 계산하기</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        2. k nearest sample</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        3. majority vote, get most common class</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        distances = [euclidean_distance(x,x_train) <span class="keyword">for</span> x_train <span class="keyword">in</span> X_train]</span><br><span class="line"></span><br><span class="line">        k_indices = np.argsort(distances)[:self.k]</span><br><span class="line">        k_nearest_labels = [self.y_train[i] <span class="keyword">for</span> i <span class="keyword">in</span> k_indices]</span><br><span class="line"></span><br><span class="line">        most_common = Counter(k_nearest_labels).most_common(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> most_common[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="분류문제-풀이"><a href="#분류문제-풀이" class="headerlink" title="분류문제 풀이"></a>분류문제 풀이</h3><ul>
<li>iris 데이터를 바탕으로 분류문제 풀이</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> matplotlib.colors <span class="keyword">import</span> ListedColormap</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"></span><br><span class="line">cmap = ListedColormap([<span class="string">&quot;#FF0000&quot;</span>, <span class="string">&quot;#00FF00&quot;</span>, <span class="string">&quot;#0000FF&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">accuracy</span>(<span class="params">y_true, y_pred</span>):</span><br><span class="line">    accuracy = np.<span class="built_in">sum</span>(y_true == y_pred) / <span class="built_in">len</span>(y_true)</span><br><span class="line">    <span class="keyword">return</span> accuracy</span><br><span class="line"></span><br><span class="line">iris = datasets.load_iris()</span><br><span class="line">X, y = iris.data, iris.target</span><br><span class="line"></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(</span><br><span class="line">        X, y, test_size=<span class="number">0.2</span>, random_state=<span class="number">1234</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">k = <span class="number">3</span></span><br><span class="line">clf = KNN(k=k)</span><br><span class="line">clf.fit(X_train, y_train)</span><br><span class="line">predictions = clf.predict(X_test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;KNN classification 정확도&quot;</span>, accuracy(y_test, predictions))</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$KNN</span> classification accuracy 1.0</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>sklearn에서도 knn 분류기가 구현되어 있다.<ul>
<li>irsis data load까지는 동일하게 진행된다.</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeiborsClassifier</span><br><span class="line"></span><br><span class="line">clf = KNeiborsClassifier(n_neighbors =<span class="number">3</span>)</span><br><span class="line">clf.fit()</span><br><span class="line"></span><br><span class="line">pred = clf.predict(X_test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;KNN classification 정확도&quot;</span>, clf.score(X_test,y_test))</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="K값과-모델-복잡도의-관계"><a href="#K값과-모델-복잡도의-관계" class="headerlink" title="K값과 모델 복잡도의 관계"></a>K값과 모델 복잡도의 관계</h3><ul>
<li>위스콘신 유방암데이터로 구현한다.</li>
<li>k의 수가 1개일 때는(적을 때는) train 데이터에 대해서만 예측력이 높고 test에서는 낮은 과적합된 모습을 보인다.</li>
<li>k의 수가 많을 수록 모델이 단순해지고 train 데이터의 정확도는 줄어든다.</li>
<li>k의 수가 10개일 때는 모델이 너무 단순해 train과 test모두에서 예측력이 낮은 모습을 보인다.</li>
<li>중간정도의 범위에서 k의 수를 선정할 필요가 있다.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_breast_cancer</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">cancer = load_breast_cancer()</span><br><span class="line">X_train , X_test , y_train , y_test = train_test_split(cancer.data,</span><br><span class="line">                                                       cancer.target,</span><br><span class="line">                                                       stratify = cancer.target, <span class="comment"># stratify 값을 target으로 지정해주면 각각의 class 비율(ratio)을 train / validation에 유지해준다. (한 쪽에 쏠려서 분배되는 것을 방지)</span></span><br><span class="line">                                                       random_state=<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line">train_acc = []</span><br><span class="line">test_acc = []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">k_indices = <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">11</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> k_indices:</span><br><span class="line">    clf = KNeiborsClassifier(n_neighbors=k)</span><br><span class="line">    clf.fit()</span><br><span class="line">    train_acc.append(clf.score(X_train,y_train))</span><br><span class="line">    test_acc.append(clf.score(X_test,y_test))</span><br><span class="line"></span><br><span class="line">plt.plot(neighbors_settings, training_accuracy, label=<span class="string">&quot;훈련 정확도&quot;</span>)</span><br><span class="line">plt.plot(neighbors_settings, test_accuracy, label=<span class="string">&quot;테스트 정확도&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;정확도&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;n_neighbors&quot;</span>)</span><br><span class="line">plt.legend(</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><img src="https://tensorflowkorea.files.wordpress.com/2017/06/2-7.png?w=1024"></p>
<p><strong>K값 선택하는 로직</strong></p>
<p>클러스터링이 잘 되었다고 하는 것은 어쨌든 클러스터내부의 유사성이 높다는 것이다.<br>따라서 중심점으로부터 데이터포인트 까지의 거리의 합이 더 이상 유의미하게 줄어들지 않을 때의 k값을 고르는 방식으로 언제 클러스터 세트가 데이터 분산을 가능한 많이 설명하는지 알 수 있다.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yjinheon.github.io/2023/10/28/machine-learning/notebook/machine-learning/7_model_pipeline/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/medium.jpg">
      <meta itemprop="name" content="JinHeon Yoon">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DataMind">
      <meta itemprop="description" content="my blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | DataMind">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/10/28/machine-learning/notebook/machine-learning/7_model_pipeline/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-10-28 00:53:30" itemprop="dateCreated datePublished" datetime="2023-10-28T00:53:30+09:00">2023-10-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-02-27 19:08:09" itemprop="dateModified" datetime="2023-02-27T19:08:09+09:00">2023-02-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/" itemprop="url" rel="index"><span itemprop="name">machine-learning</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/notebook/" itemprop="url" rel="index"><span itemprop="name">notebook</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/notebook/machine-learning/" itemprop="url" rel="index"><span itemprop="name">machine-learning</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>모델 파이프라인 구축 관련 내용 전부</p>
<p>파이토치 skorch 관련 내용 정리</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yjinheon.github.io/2023/10/28/machine-learning/notebook/machine-learning/tensorflow/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/medium.jpg">
      <meta itemprop="name" content="JinHeon Yoon">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DataMind">
      <meta itemprop="description" content="my blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | DataMind">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/10/28/machine-learning/notebook/machine-learning/tensorflow/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-10-28 00:53:30" itemprop="dateCreated datePublished" datetime="2023-10-28T00:53:30+09:00">2023-10-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-02-27 19:08:09" itemprop="dateModified" datetime="2023-02-27T19:08:09+09:00">2023-02-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/" itemprop="url" rel="index"><span itemprop="name">machine-learning</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/notebook/" itemprop="url" rel="index"><span itemprop="name">notebook</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/notebook/machine-learning/" itemprop="url" rel="index"><span itemprop="name">machine-learning</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Tensorflow"><a href="#Tensorflow" class="headerlink" title="Tensorflow"></a>Tensorflow</h2><h3 id="Tensor-연산"><a href="#Tensor-연산" class="headerlink" title="Tensor 연산"></a>Tensor 연산</h3><h4 id="Tensor"><a href="#Tensor" class="headerlink" title="Tensor"></a>Tensor</h4><hr>
<p><strong><em>Concept</em></strong></p>
<ul>
<li><strong>tensor</strong> :</li>
<li><strong>rank</strong> :</li>
<li></li>
</ul>
<hr>
<h4 id="Rank"><a href="#Rank" class="headerlink" title="Rank"></a>Rank</h4><p>TensorFlow 시스템에서, tensor는 <em>rank</em>라는 차원 단위로 표현된다.<br>Tensor rank는 행렬의 rank와 다르다.<br>Tensor rank(<em>order</em>, <em>degree</em>, <em>-n_dimension</em> 으로도 언급됨)는 tensor의 차원수다.<br>예를 들어, 아래 tensor(Python 리스트로 정의)의 rank는 2다.</p>
<pre><code>t = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]
</code></pre>
<p>rank 2인 tensor는 행렬, rank 1인 tensor는 벡터로 생각할 수 있다.<br>rank 2인 tensor는 <code>t[i, j]</code> 형식으로 원소에 접근할 수 있다.<br>rank 3인 tensor는 <code>t[i, j, k]</code> 형식으로 원소를 지정할 수 있다.</p>
<h4 id="Shape"><a href="#Shape" class="headerlink" title="Shape"></a>Shape</h4><p>TensorFlow 문서는 tensor 차원을 표현할 때 세 가지 기호를 사용한다. rank, shape, Demension number.<br>아래 표는 그 세 가지의 관계를 보여준다:</p>
<table>
<thead>
<tr>
<th>Rank</th>
<th>Shape</th>
<th>Dimension number</th>
<th>Example</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>[]</td>
<td>0-D</td>
<td>A 0-D tensor.  A scalar.</td>
</tr>
<tr>
<td>1</td>
<td>[D0]</td>
<td>1-D</td>
<td>A 1-D tensor with shape [5].</td>
</tr>
<tr>
<td>2</td>
<td>[D0, D1]</td>
<td>2-D</td>
<td>A 2-D tensor with shape [3, 4].</td>
</tr>
<tr>
<td>3</td>
<td>[D0, D1, D2]</td>
<td>3-D</td>
<td>A 3-D tensor with shape [1, 4, 3].</td>
</tr>
<tr>
<td>n</td>
<td>[D0, D1, … Dn-1]</td>
<td>n-D</td>
<td>A tensor with shape [D0, D1, … Dn-1].</td>
</tr>
</tbody></table>
<h3 id="Tensorflow-전처리-파이프라인-구현"><a href="#Tensorflow-전처리-파이프라인-구현" class="headerlink" title="Tensorflow 전처리 파이프라인 구현"></a>Tensorflow 전처리 파이프라인 구현</h3><p><strong>ref</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://doubly8f.netlify.app/%EA%B0%9C%EB%B0%9C/2020/08/19/tf-loading-preprocessing-data/">Tensorflow 데이터 로딩 및 전처리 파이프라인 구현하기</a></li>
</ul>
<!--
tensorflow를 사용하면서 가장 까다로운 부분이 입력데이터 파이프라인 처리해서 모델까지 데이터 흐르는 구간을 만드는게 아닌가 싶다. 데이터의 양이 많을때, 적을때, 그리고 형태에 따라 다양하게 구현을 해야하기 때문에 A라는 방법을 써서 구현하다 보면 모델에 데이터를 넣는 부분이 막힐때가 있다. 그래서 텐서플로우에서 입력데이터를 어떻게 처리해야 하는지에 대한 내용을 정리-->

<ul>
<li><strong>Dataset class 확인(tensorflow에서 데이터를 읽을 때 중심이 됨)</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">dir</span>(tf.data.Dataset):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (m.startswith(<span class="string">&quot;_&quot;</span>) <span class="keyword">or</span> m.endswith(<span class="string">&quot;_&quot;</span>)):</span><br><span class="line">        func = <span class="built_in">getattr</span>(tf.data.Dataset, m)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(func, <span class="string">&quot;__doc__&quot;</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;● &#123;:21s&#125;&#123;&#125;&quot;</span>.<span class="built_in">format</span>(m + <span class="string">&quot;()&quot;</span>, func.__doc__.split(<span class="string">&quot;\n&quot;</span>)[<span class="number">0</span>]))</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>tfds 관련함수들</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">X = tf.<span class="built_in">range</span>(<span class="number">10</span>)</span><br><span class="line">dataset = tf.data.Dataset.from_tensor_slices(X)</span><br><span class="line">dataset</span><br><span class="line"></span><br><span class="line">tf.data.Dataset.Range(<span class="number">10</span>) <span class="comment"># 위와 동일</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> dataset: <span class="comment"># Tensor의 형태를 출력</span></span><br><span class="line">  <span class="built_in">print</span>(item)</span><br><span class="line"></span><br><span class="line"><span class="comment"># repeat(): 원본 데이터셋의 아이템을 N차례 반복하는 새로운 데이터셋을 반환 (복사하는 것은 아님)</span></span><br><span class="line"><span class="comment"># batch() : 아이템을 N개의 그룹으로 묶는다</span></span><br><span class="line"><span class="comment"># batch(drop_remainder=True): 마지막에 N보다 부족한 길이의 배치는 버림 (=모든 배치의 크기가 동일)</span></span><br><span class="line">dataset = dataset.repeat(<span class="number">3</span>).batch(<span class="number">7</span>)</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> dataset:</span><br><span class="line">    <span class="built_in">print</span>(item)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 데이터에 원하는 전처리 작업에도 적용 (이미지 크기 변환, 회전계산)</span></span><br><span class="line"><span class="comment"># map(num_parallel_calls) 를 하면 여러개의 스레드로 나누어서 속도를 높여 처리 가능</span></span><br><span class="line">dataset = dataset.<span class="built_in">map</span>(<span class="keyword">lambda</span> x: x*<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># map은 각 아이템에 변환을 적용하지만 apply는 데이터셋 전체에 변환을 적용</span></span><br><span class="line"><span class="comment"># dataset = dataset.apply(tf.data.experimental.unbatch()) # deprecated</span></span><br><span class="line">dataset = dataset.unbatch()</span><br><span class="line"></span><br><span class="line"><span class="comment"># filter 할때</span></span><br><span class="line">dataset = dataset.<span class="built_in">filter</span>(labmda x: x &lt;<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 데이터셋에 있는 몇개의 아이템만 보고싶을때</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> dataset.take(<span class="number">3</span>):</span><br><span class="line">    <span class="built_in">print</span>(item)</span><br></pre></td></tr></table></figure>

<h4 id="데이터-셔플하기"><a href="#데이터-셔플하기" class="headerlink" title="데이터 셔플하기"></a><strong>데이터 셔플하기</strong></h4><ul>
<li>경사 하강법은 훈련 세트에 있는 샘플이 독립적이고 동일한 분포일때 최고의 성능을 발휘 (&#x3D;shuffle이 필요한 이유)</li>
<li>동작순서<ul>
<li>원본 데이터셋의 처음 아이템을 buffer_size 개수만큼 추출하여 버퍼에 채운다.</li>
<li>새로운 아이템이 요청되면 이 버퍼에서 랜덤하게 하나를 꺼내 반환</li>
<li>원본 데이터셋에서 새로운 아이템을 추출하여 비워진 버퍼를 채운다.</li>
<li>원본 데이터셋의 모든 아이템이 사용될 때까지 반복</li>
<li>버퍼가 비워질 때까지 계속하여 랜덤하게 아이템을 반환</li>
</ul>
</li>
<li>버퍼의 크기를 충분히 크게 하는 것이 중요하다. (&#x3D;셔플링 효과를 올리기 위해서), 메모리의 크기를 넘지 않도록, 데이터의 크기를 넘지 않도록</li>
<li>완벽한 셔플링을 위해서는 버퍼크기가 데이터셋의 크기와 동일</li>
<li>셔플링되는 순서를 동일하게 만들기 위해 랜덤 시드를 부여<ul>
<li><strong>반드시 suffle을 먼저 한뒤에 repeat를 해야함</strong></li>
<li><strong>일단 아래 순서로 할 것 : shuffle , repeat, map, batch</strong></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/51485781/tf-dataset-api-is-the-following-sequence-correct-map-cache-shuffle-batch-repea">순서레퍼런스</a></li>
</ul>
</li>
</ul>
<p><strong>ref</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://doubly8f.netlify.app/%EA%B0%9C%EB%B0%9C/2020/08/19/tf-loading-preprocessing-data/">Tensorflow 데이터 로딩 및 전처리 파이프라인 구현하기</a></li>
</ul>
<p>tensorflow를 사용하면서 가장 까다로운 부분이 입력데이터 파이프라인 처리해서 모델까지 데이터 흐르는 구간을 만드는게 아닌가 싶다. 데이터의 양이 많을때, 적을때, 그리고 형태에 따라 다양하게 구현을 해야하기 때문에 A라는 방법을 써서 구현하다 보면 모델에 데이터를 넣는 부분이 막힐때가 있다. 그래서 텐서플로우에서 입력데이터를 어떻게 처리해야 하는지에 대한 내용을 정리</p>
<ul>
<li><strong>Dataset class 확인(tensorflow에서 데이터를 읽을 때 중심이 됨)</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">dir</span>(tf.data.Dataset):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (m.startswith(<span class="string">&quot;_&quot;</span>) <span class="keyword">or</span> m.endswith(<span class="string">&quot;_&quot;</span>)):</span><br><span class="line">        func = <span class="built_in">getattr</span>(tf.data.Dataset, m)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(func, <span class="string">&quot;__doc__&quot;</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;● &#123;:21s&#125;&#123;&#125;&quot;</span>.<span class="built_in">format</span>(m + <span class="string">&quot;()&quot;</span>, func.__doc__.split(<span class="string">&quot;\n&quot;</span>)[<span class="number">0</span>]))</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>tfds 관련함수들</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">X = tf.<span class="built_in">range</span>(<span class="number">10</span>)</span><br><span class="line">dataset = tf.data.Dataset.from_tensor_slices(X)</span><br><span class="line">dataset</span><br><span class="line"></span><br><span class="line">tf.data.Dataset.Range(<span class="number">10</span>) <span class="comment"># 위와 동일</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> dataset: <span class="comment"># Tensor의 형태를 출력</span></span><br><span class="line">  <span class="built_in">print</span>(item)</span><br><span class="line"></span><br><span class="line"><span class="comment"># repeat(): 원본 데이터셋의 아이템을 N차례 반복하는 새로운 데이터셋을 반환 (복사하는 것은 아님)</span></span><br><span class="line"><span class="comment"># batch() : 아이템을 N개의 그룹으로 묶는다</span></span><br><span class="line"><span class="comment"># batch(drop_remainder=True): 마지막에 N보다 부족한 길이의 배치는 버림 (=모든 배치의 크기가 동일)</span></span><br><span class="line">dataset = dataset.repeat(<span class="number">3</span>).batch(<span class="number">7</span>)</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> dataset:</span><br><span class="line">    <span class="built_in">print</span>(item)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 데이터에 원하는 전처리 작업에도 적용 (이미지 크기 변환, 회전계산)</span></span><br><span class="line"><span class="comment"># map(num_parallel_calls) 를 하면 여러개의 스레드로 나누어서 속도를 높여 처리 가능</span></span><br><span class="line">dataset = dataset.<span class="built_in">map</span>(<span class="keyword">lambda</span> x: x*<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># map은 각 아이템에 변환을 적용하지만 apply는 데이터셋 전체에 변환을 적용</span></span><br><span class="line"><span class="comment"># dataset = dataset.apply(tf.data.experimental.unbatch()) # deprecated</span></span><br><span class="line">dataset = dataset.unbatch()</span><br><span class="line"></span><br><span class="line"><span class="comment"># filter 할때</span></span><br><span class="line">dataset = dataset.<span class="built_in">filter</span>(labmda x: x &lt;<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 데이터셋에 있는 몇개의 아이템만 보고싶을때</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> dataset.take(<span class="number">3</span>):</span><br><span class="line">    <span class="built_in">print</span>(item)</span><br></pre></td></tr></table></figure>

<h4 id="데이터-셔플하기-1"><a href="#데이터-셔플하기-1" class="headerlink" title="데이터 셔플하기"></a><strong>데이터 셔플하기</strong></h4><ul>
<li>경사 하강법은 훈련 세트에 있는 샘플이 독립적이고 동일한 분포일때 최고의 성능을 발휘 (&#x3D;shuffle이 필요한 이유)</li>
<li>동작순서<ul>
<li>원본 데이터셋의 처음 아이템을 buffer_size 개수만큼 추출하여 버퍼에 채운다.</li>
<li>새로운 아이템이 요청되면 이 버퍼에서 랜덤하게 하나를 꺼내 반환</li>
<li>원본 데이터셋에서 새로운 아이템을 추출하여 비워진 버퍼를 채운다.</li>
<li>원본 데이터셋의 모든 아이템이 사용될 때까지 반복</li>
<li>버퍼가 비워질 때까지 계속하여 랜덤하게 아이템을 반환</li>
</ul>
</li>
<li>버퍼의 크기를 충분히 크게 하는 것이 중요하다. (&#x3D;셔플링 효과를 올리기 위해서), 메모리의 크기를 넘지 않도록, 데이터의 크기를 넘지 않도록</li>
<li>완벽한 셔플링을 위해서는 버퍼크기가 데이터셋의 크기와 동일</li>
<li>셔플링되는 순서를 동일하게 만들기 위해 랜덤 시드를 부여<ul>
<li><strong>반드시 suffle을 먼저 한뒤에 repeat를 해야함</strong></li>
<li><strong>일단 아래 순서로 할 것 : shuffle , repeat, map, batch</strong></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/51485781/tf-dataset-api-is-the-following-sequence-correct-map-cache-shuffle-batch-repea">순서레퍼런스</a></li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tf.random.set_seed(<span class="number">42</span>) <span class="comment"># 셔플링 순서를 동일하게</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># (2) shuffle하고 repeat</span></span><br><span class="line">dataset = tf.data.Dataset.<span class="built_in">range</span>(<span class="number">10</span>)</span><br><span class="line">dataset = dataset.shuffle(buffer_size=<span class="number">3</span>, seed=<span class="number">42</span>).repeat(<span class="number">3</span>).batch(<span class="number">7</span>) <span class="comment"># 반복마다 순서가 달라지도록</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> dataset:</span><br><span class="line">    <span class="built_in">print</span>(item)</span><br></pre></td></tr></table></figure>

<h4 id="여러-파일에서-한줄씩-번갈아-읽기"><a href="#여러-파일에서-한줄씩-번갈아-읽기" class="headerlink" title="여러 파일에서 한줄씩 번갈아 읽기"></a>여러 파일에서 한줄씩 번갈아 읽기</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">[[여러]] 파일로 데이터 나누기</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> fetch_california_housing</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"></span><br><span class="line">housing = fetch_california_housing()</span><br><span class="line">X_train_full, X_test, y_train_full, y_test = train_test_split(</span><br><span class="line">    housing.data, housing.target.reshape(-<span class="number">1</span>, <span class="number">1</span>), random_state=<span class="number">42</span>)</span><br><span class="line">X_train, X_valid, y_train, y_valid = train_test_split(</span><br><span class="line">    X_train_full, y_train_full, random_state=<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line">scaler = StandardScaler()</span><br><span class="line">scaler.fit(X_train)</span><br><span class="line">X_mean = scaler.mean_</span><br><span class="line">X_std = scaler.scale_</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">save_to_multiple_csv_files</span>(<span class="params">data, name_prefix, header=<span class="literal">None</span>, n_parts=<span class="number">10</span></span>):</span><br><span class="line">    housing_dir = os.path.join(<span class="string">&quot;datasets&quot;</span>, <span class="string">&quot;housing&quot;</span>)</span><br><span class="line">    os.makedirs(housing_dir, exist_ok=<span class="literal">True</span>)</span><br><span class="line">    path_format = os.path.join(housing_dir, <span class="string">&quot;my_&#123;&#125;_&#123;:02d&#125;.csv&quot;</span>)</span><br><span class="line"></span><br><span class="line">    filepaths = []</span><br><span class="line">    m = <span class="built_in">len</span>(data)</span><br><span class="line">    <span class="keyword">for</span> file_idx, row_indices <span class="keyword">in</span> <span class="built_in">enumerate</span>(np.array_split(np.arange(m), n_parts)):</span><br><span class="line">        part_csv = path_format.<span class="built_in">format</span>(name_prefix, file_idx)</span><br><span class="line">        filepaths.append(part_csv)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(part_csv, <span class="string">&quot;wt&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">if</span> header <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                f.write(header)</span><br><span class="line">                f.write(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">            <span class="keyword">for</span> row_idx <span class="keyword">in</span> row_indices:</span><br><span class="line">                f.write(<span class="string">&quot;,&quot;</span>.join([<span class="built_in">repr</span>(col) <span class="keyword">for</span> col <span class="keyword">in</span> data[row_idx]]))</span><br><span class="line">                f.write(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> filepaths</span><br><span class="line"></span><br><span class="line">train_data = np.c_[X_train, y_train]</span><br><span class="line">valid_data = np.c_[X_valid, y_valid]</span><br><span class="line">test_data = np.c_[X_test, y_test]</span><br><span class="line">header_cols = housing.feature_names + [<span class="string">&quot;MedianHouseValue&quot;</span>]</span><br><span class="line">header = <span class="string">&quot;,&quot;</span>.join(header_cols)</span><br><span class="line"></span><br><span class="line">train_filepaths = save_to_multiple_csv_files(train_data, <span class="string">&quot;train&quot;</span>, header, n_parts=<span class="number">20</span>)</span><br><span class="line">valid_filepaths = save_to_multiple_csv_files(valid_data, <span class="string">&quot;valid&quot;</span>, header, n_parts=<span class="number">10</span>)</span><br><span class="line">test_filepaths = save_to_multiple_csv_files(test_data, <span class="string">&quot;test&quot;</span>, header, n_parts=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">pd.read_csv(train_filepaths[<span class="number">0</span>]).head()</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(train_filepaths[<span class="number">0</span>]) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="built_in">print</span>(f.readline(), end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">데이터 나눠서 읽기</span><br><span class="line"></span><br><span class="line">filepath_dataset = tf.data.Dataset.list_files(train_filepaths, seed=<span class="number">42</span>) <span class="comment"># default: shuffle=True</span></span><br><span class="line">n_reader = <span class="number">5</span></span><br><span class="line"><span class="comment"># skip(1): header</span></span><br><span class="line"><span class="comment"># interleave(): filepath_dataset에 있는 다섯개의 파일 경로에서 데이터를 읽는 데이터셋을 생성,TextLineDataset 5개를 순회하면서 한줄씩 읽는다.</span></span><br><span class="line"><span class="comment"># 파일 길이가 동일할때 interleave를 사용하는게 좋음 (각파일에서 한줄씩 읽음)</span></span><br><span class="line"><span class="comment"># num_parallel_calls 매개변수에 원하는 스레드 개수를 지정</span></span><br><span class="line"><span class="comment"># tf.data.experimental.AUTOTUNE: 을 지정하면 텐서플로가 가용한 CPU를 기반으로 동적으로 적절한 스레드 개수를 선택할 수 있다.</span></span><br><span class="line"><span class="comment"># cycle_length: 동시에 처리할 입력 개수를 지정</span></span><br><span class="line">dataset = filepath_dataset.interleave(<span class="keyword">lambda</span> filepath: tf.data.TextLineDataset(filepath).sip(<span class="number">1</span>), cycle_length=n_readers)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 각 TextLineDataset의 순서가 랜덤으로 첫번째 해당하는 행을 읽음 (순서가 랜덤)</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> dataset.take(<span class="number">5</span>):</span><br><span class="line">  <span class="built_in">print</span>(line.numpy())</span><br></pre></td></tr></table></figure>

<ul>
<li>데이터 전처리</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 평균과 표준편차를 미리 계산했다고 가정함</span></span><br><span class="line">X_mean, X_std = [...]</span><br><span class="line">n_inputs = <span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@tf.fuction</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">preprocess</span>(<span class="params">line</span>):</span><br><span class="line">  defs = [<span class="number">0.</span>] * n_inputs + [tf.constant([], dtype=tf.float32)]</span><br><span class="line">  fields = tf.io.decode_csv(line, record_defaults=defs) <span class="comment"># csv의 한 라인을 받아 파싱</span></span><br><span class="line">  <span class="comment"># stack() 모든 텐서를 쌓아 1D 배열을 생성</span></span><br><span class="line">  x = tf.stack(fields[:-<span class="number">1</span>]) <span class="comment"># &lt;tf.Tensor: shape=(6,), dtype=int32, numpy=array([1, 2, 3, 4, 5, 6], dtype=int32)&gt;</span></span><br><span class="line">  y = tf.stack(fields[-<span class="number">1</span>:]) <span class="comment"># &lt;tf.Tensor: shape=(1,), dtype=int32, numpy=array([7], dtype=int32)&gt;</span></span><br><span class="line">  <span class="keyword">return</span> (x - X_mean) / X_std, y</span><br><span class="line"></span><br><span class="line">preprocess(<span class="string">b&#x27;4.2083, 44.0, 5.332,....&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">record_defaults=[<span class="number">0</span>, np.nan, tf.constant(np.nan, dtype=tf.float64), <span class="string">&quot;Hello&quot;</span>, tf.constant([])]</span><br><span class="line">parsed_fields = tf.io.decode_csv(<span class="string">&#x27;1,2,3,4,5&#x27;</span>, record_defaults)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[&lt;tf.Tensor: shape=(), dtype=int32, numpy=1&gt;,</span></span><br><span class="line"><span class="string"> &lt;tf.Tensor: shape=(), dtype=float32, numpy=2.0&gt;,</span></span><br><span class="line"><span class="string"> &lt;tf.Tensor: shape=(), dtype=float64, numpy=3.0&gt;,</span></span><br><span class="line"><span class="string"> &lt;tf.Tensor: shape=(), dtype=string, numpy=b&#x27;4&#x27;&gt;,</span></span><br><span class="line"><span class="string"> &lt;tf.Tensor: shape=(), dtype=float32, numpy=5.0&gt;]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">parsed_fields = tf.io.decode_csv(<span class="string">&#x27;,,,,5&#x27;</span>, record_defaults)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[&lt;tf.Tensor: shape=(), dtype=int32, numpy=0&gt;,</span></span><br><span class="line"><span class="string"> &lt;tf.Tensor: shape=(), dtype=float32, numpy=nan&gt;,</span></span><br><span class="line"><span class="string"> &lt;tf.Tensor: shape=(), dtype=float64, numpy=nan&gt;,</span></span><br><span class="line"><span class="string"> &lt;tf.Tensor: shape=(), dtype=string, numpy=b&#x27;Hello&#x27;&gt;,</span></span><br><span class="line"><span class="string"> &lt;tf.Tensor: shape=(), dtype=float32, numpy=5.0&gt;]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Exception</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    parsed_fields = tf.io.decode_csv(<span class="string">&#x27;,,,,&#x27;</span>, record_defaults) <span class="comment"># case 1</span></span><br><span class="line">    parsed_fields = tf.io.decode_csv(<span class="string">&#x27;1,2,3,4,5,6,7&#x27;</span>, record_defaults) <span class="comment"># case 2</span></span><br><span class="line"><span class="keyword">except</span> tf.errors.InvalidArgumentError <span class="keyword">as</span> ex:</span><br><span class="line">    <span class="built_in">print</span>(ex)</span><br><span class="line"></span><br><span class="line"><span class="comment"># case 1 : Field 4 is required but missing in record 0! [Op:DecodeCSV]</span></span><br><span class="line"><span class="comment"># case 2 : Expect 5 fields but have 7 in record 0 [Op:DecodeCSV]</span></span><br></pre></td></tr></table></figure>

<h4 id="데이터-적재와-전처리-한번에"><a href="#데이터-적재와-전처리-한번에" class="headerlink" title="데이터 적재와 전처리 한번에"></a>데이터 적재와 전처리 한번에</h4><ul>
<li><p>위 코드를 재사용하기 위해서 하나의 함수로 생성</p>
</li>
<li><p>CSV파일에서 캘리포니아 주택 데이터셋을 효율적으로 적재하고 전처리, 셔플링, 반복, 배치를 적용한 데이터셋을 만들어 반환</p>
</li>
<li><p><code>prefetch()</code></p>
<ul>
<li>훈련 속도를 더 빠르게</li>
<li>prefetch(1)을 호출하면 데이터셋은 항상 한 배치가 미리 준비되도록 최선을 (&#x3D;알고리즘이 한 배치로 작업하는 동안 이 데이터셋이 동시에 다음 배치를 준비)</li>
<li>GPU에서 훈련하는 스텝을 수행하는 것보다 짧은 시간안에 한 배치 데이터를 준비할 수 있다. (&#x3D;GPU 100%활용하는 방법)</li>
<li>nterleave와 map에 num_parallel_calls을 함께 사용하면 데이터를 적재하고 전처리할때 CPU의 멀티코어를 사용해 더 빠르게 준비 가능</li>
<li>prefetch는 일반적으로 하나도 충분, tf.data.experimental.AUTOTUNE을 전달하면 텐서플로가 자동으로 결정</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">csv_reader_dataset</span>(<span class="params">filepaths, repeat=<span class="number">1</span>, n_readers=<span class="number">5</span>,</span></span><br><span class="line"><span class="params">                       n_read_threads=<span class="literal">None</span>, shuffle_buffer_size=<span class="number">10000</span>,</span></span><br><span class="line"><span class="params">                       n_parse_threads=<span class="number">5</span>, batch_size=<span class="number">32</span></span>):</span><br><span class="line">    dataset = tf.data.Dataset.list_files(filepaths).repeat(repeat)</span><br><span class="line">    dataset = dataset.interleave(</span><br><span class="line">        <span class="keyword">lambda</span> filepath: tf.data.TextLineDataset(filepath).skip(<span class="number">1</span>),</span><br><span class="line">        cycle_length=n_readers, num_parallel_calls=n_read_threads)</span><br><span class="line">    dataset = dataset.shuffle(shuffle_buffer_size)</span><br><span class="line">    dataset = dataset.<span class="built_in">map</span>(preprocess, num_parallel_calls=n_parse_threads)</span><br><span class="line">    dataset = dataset.batch(batch_size)</span><br><span class="line">    <span class="keyword">return</span> dataset.prefetch(<span class="number">1</span>) <span class="comment"># 학습 성능에 아주 중요한 역할</span></span><br><span class="line"></span><br><span class="line">tf.random.set_seed(<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line">train_set = csv_reader_dataset(train_filepaths, batch_size=<span class="number">3</span>)</span><br><span class="line"><span class="keyword">for</span> X_batch, y_batch <span class="keyword">in</span> train_set.take(<span class="number">2</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;X =&quot;</span>, X_batch)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;y =&quot;</span>, y_batch)</span><br><span class="line">    <span class="built_in">print</span>()</span><br></pre></td></tr></table></figure>

<ul>
<li>csv_reader_dataset()함수로 훈련 세트로 사용할 데이터셋을 만들기</li>
<li><a target="_blank" rel="noopener" href="https://doubly8f.netlify.app/%EA%B0%9C%EB%B0%9C/2020/08/19/tf-loading-preprocessing-data/">https://doubly8f.netlify.app/%EA%B0%9C%EB%B0%9C/2020/08/19/tf-loading-preprocessing-data/</a></li>
</ul>
<h2 id="Modeling-with-Keras"><a href="#Modeling-with-Keras" class="headerlink" title="Modeling with Keras"></a>Modeling with Keras</h2><h3 id="Layers-Function"><a href="#Layers-Function" class="headerlink" title="Layers Function"></a>Layers Function</h3><ul>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/44747343/keras-input-explanation-input-shape-units-batch-size-dim-etc">Unit,Shape,Input Shape,Dimention에 대한 자세한 설명</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/keras-team/keras-docs-ko/blob/master/sources/layers/core.md">Keras 한국어문서</a></li>
</ul>
<hr>
<p><strong><em>Concept</em></strong></p>
<ul>
<li><strong>shape</strong> : 배열의 각 차원에 몇개의 요소가 있는지에 대한 정보를 담고있는 tuple<ul>
<li><code>(40,4,10)</code> 은 1차원에 40개, 2차원에 4개 , 3차원에 10개의 요소들을 담고있는 3차원 텐서를 의미한다.</li>
</ul>
</li>
<li><strong>input_shape</strong> : 기본적으로 첫번째 차원을 제외한 배열의 차원정보.</li>
<li><strong>unit</strong> : 출력층의 차원 수. output layer의 shape을 결정함.</li>
<li><strong>kernel</strong> : 층에서 만들어진 <code>가중치 행렬weight matrix</code></li>
<li><strong>Dense</strong> :<code>activation(dot(input, kernel) + bias)</code> 계산</li>
<li><strong>Input</strong> : 텐서 생성</li>
<li><strong>Activation</strong> : 출력값에 활성화함수 적용</li>
<li><strong>Dropout</strong> : 입력에 Dropout 적용.Dropout은 노드를 지정한 비율만큼 랜덤으로 드롭해서 너무 많은 노드들이 학습\되어 과적합 되는 것을 방지해 준다.노드를 랜덤으로끄고 나머지 노드를 학습을 더 시켜서 퍼포먼스를 향상시킨다.</li>
<li><strong>Reshape</strong> : 출력을 특정형태로 변환.</li>
<li><strong>Flatten</strong> : 입력을 1차원 텐서로 변환. batch size에는 영향을 주지 않음.</li>
<li><strong>Masking</strong> : 시퀀스를 마스킹. 따로 정리</li>
</ul>
<hr>
<h4 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h4><ul>
<li>케라스 텐서 생성</li>
<li>케라스 텐서는 백엔드(Theano, TensorFlow 혹은 CNTK)에서 사용되는 텐서에 몇가지 속성을 추가한 것으로, 이를 통해 모델의 입력과 출력을 아는 것만으로도 케라스 모델을 만들 수 있습니다.</li>
</ul>
<p>예를 들어 a, b와 c가 케라스 텐서라고 하면 model &#x3D; Model(input&#x3D;[a, b], output&#x3D;c)만으로도 모델을 생성할 수 있습니다.</p>
<p>케라스 텐서에 추가된 속성은 다음과 같습니다.<br><code>_keras_shape: 케라스의 형태 유추를 통해 전파되는 정수 튜플.</code><br><code>_keras_history: 텐서에 적용되는 마지막 층. 해당 층에서 전체 모델 전체의 그래프를 추출할 수 있습니다.</code></p>
<p><strong>인자</strong></p>
<ul>
<li><code>shape</code>: int로 이루어진 튜플. 배치 축을 포함하지 않습니다. 예를 들어 shape&#x3D;(32,)는 입력이 32차원 벡터의 배치라는 것을 나타냅니다.</li>
<li><code>batch_shape</code>: int로 이루어진 튜플. 배치 축을 포함합니다. 예를 들어 batch_shape&#x3D;(10, 32)는 입력이 10개의 32차원 벡터로 이루어진 배치라는 것을 나타냅니다. batch_shape&#x3D;(None, 32)는 임의의 수의 32차원 벡터로 이루어진 배치를 뜻합니다.</li>
<li><code>name</code>: str, 층의 문자열 이름. 모델 내에서 이름은 고유해야 하며 이미 사용한 이름은 다시 사용할 수 없습니다. 따로 지정하지 않을 경우, 자동으로 생성됩니다.</li>
<li><code>dtype</code>: str, 입력 데이터의 자료형(float32, float64, int32…) 입니다.</li>
<li><code>sparse</code>: bool, 생성할 플레이스홀더가 희소sparse한지 여부를 나타냅니다.</li>
<li><code>tensor</code>: 해당 인자가 주어진 경우 Input 층은 해당 텐서의 래퍼로 사용되며, 새로운 플레이스홀더 텐서를 만들지 않습니다.</li>
</ul>
<h4 id="Dense"><a href="#Dense" class="headerlink" title="Dense"></a>Dense</h4><ul>
<li><p><code>output = activation(dot(input, kernel) + bias)을 실행</code> </p>
<ul>
<li><code>activation</code>은 activation 인자로 전달되는 원소별element-wise 활성화 함수 </li>
<li><code>kernel</code>은 층에서 만들어진 <code>가중치 행렬weight matrix</code> </li>
<li><code>bias</code>는 층에서 만들어진 편향bias 벡터이며 ‘use_bias&#x3D;True’인 경우에만 적용 가능</li>
</ul>
</li>
<li><p>layer의 입력텐서의 rank가 2보다 클 경우 가중치 행렬과 내정을 하기 전에 1d 벡터로 형태를 변환해야함</p>
</li>
<li><p><strong>unit(출력층의 차원 수)과 <code>(*,입력층의 차원)</code> 형태의 배열을 인자로 받고 <code>(*,units)</code> 형태의 배열을 출력한다.</strong></p>
</li>
<li><p>input_shape 예시</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">input_shape = (<span class="number">50</span>,<span class="number">50</span>,<span class="number">3</span>) <span class="comment"># regardless of how many images I have, each image has this shape  </span></span><br><span class="line">input_shape = (<span class="number">50</span>,<span class="number">50</span>,<span class="number">3</span>)</span><br><span class="line">  [[regardless]] of how many images I have, each image has this shape  </span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">- Dense 예시</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line">model = Sequential([</span><br><span class="line">                   Dense(32, input_shape = (16,))</span><br><span class="line">                   # (*,16)  형태의 배열을 받아서</span><br><span class="line">                   # (*,32) 형태의 배열을 출력한다.</span><br><span class="line">                   Dense(10)</span><br><span class="line">                   ]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">keras.layers.Dense(units,</span><br><span class="line"> activation=<span class="literal">None</span>,</span><br><span class="line"> use_bias=<span class="literal">True</span>,</span><br><span class="line"> kernel_initializer=<span class="string">&#x27;glorot_uniform&#x27;</span>,</span><br><span class="line"> bias_initializer=<span class="string">&#x27;zeros&#x27;</span>,</span><br><span class="line"> kernel_regularizer=<span class="literal">None</span>,</span><br><span class="line"> bias_regularizer=<span class="literal">None</span>, </span><br><span class="line"> activity_regularizer=<span class="literal">None</span>, </span><br><span class="line"> kernel_constraint=<span class="literal">None</span>, </span><br><span class="line"> bias_constraint=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>

<p><strong>Dense Parameters</strong></p>
<ul>
<li><code>units</code>: 양의 int. 출력값의 차원 크기를 결정.</li>
<li><code>activation</code>: 사용할 활성화 함수. 기본값은 None이며, 이 경우 활성화 함수가 적용되지 않는다.(a(x) &#x3D; x).</li>
<li><code>use_bias</code>: bool. 층의 연산에 편향을 적용할지 여부를 결정.</li>
<li><code>kernel_initializer</code>: kernel 가중치 행렬의 초기화 함수를 결정. 이 가중치는 입력값에 곱해져서 선형변환하는 연산에 사용.</li>
<li><code>bias_initializer</code>: 편향 벡터의 초기화 함수를 결정.</li>
<li><code>kernel_regularizer</code>: kernel 가중치 행렬에 적용할 규제 함수regularizer를 결정.</li>
<li><code>bias_regularizer</code>: 편향 벡터에 적용할 규제 함수를 결정.</li>
<li><code>activity_regularizer</code>: 층의 출력값에 적용할 규제 함수를 결정.</li>
<li><code>kernel_constraint</code>: kernel 가중치 행렬에 적용할 제약constraints을 결정. </li>
<li><code>bias_constraint</code>: 편향 벡터에 적용할 제약을 결정.</li>
<li><code>units</code>: 양의 int. 출력값의 차원 크기를 결정.</li>
</ul>
<h4 id="Activation"><a href="#Activation" class="headerlink" title="Activation"></a>Activation</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keras.layers.Activation(activation)</span><br></pre></td></tr></table></figure>

<ul>
<li>출력값에 활성화함수 적용</li>
<li>모델의 첫 번째 층으로 Activation층을 사용하려면 input_shape로 형태를 지정해야 한다.</li>
<li><code>input_shape</code>는 int로 이루어진 튜플로 <strong>배치 축을 포함하지 않는다.</strong></li>
</ul>
<h4 id="Flatten"><a href="#Flatten" class="headerlink" title="Flatten"></a>Flatten</h4><ul>
<li>input을 1차원으로 바꾼다.</li>
<li>layer의 입력텐서의 rank 가 2보다 클 경우 가중치와 내적을 하기 전에 1차원 배열로 형태를 변환할때 사용한다.</li>
</ul>
<h4 id="Conv2d"><a href="#Conv2d" class="headerlink" title="Conv2d"></a>Conv2d</h4><h3 id="Sequential-API"><a href="#Sequential-API" class="headerlink" title="Sequential API"></a>Sequential API</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">from</span> tensorflow <span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras <span class="keyword">import</span> layers</span><br><span class="line"></span><br><span class="line">model1 = keras.Sequential(</span><br><span class="line">                          []</span><br><span class="line"></span><br><span class="line">                          )</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yjinheon.github.io/2023/10/28/machine-learning/notebook/machine-learning/unsupervised_learning/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/medium.jpg">
      <meta itemprop="name" content="JinHeon Yoon">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DataMind">
      <meta itemprop="description" content="my blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | DataMind">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/10/28/machine-learning/notebook/machine-learning/unsupervised_learning/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-10-28 00:53:30" itemprop="dateCreated datePublished" datetime="2023-10-28T00:53:30+09:00">2023-10-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-02-27 19:08:09" itemprop="dateModified" datetime="2023-02-27T19:08:09+09:00">2023-02-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/" itemprop="url" rel="index"><span itemprop="name">machine-learning</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/notebook/" itemprop="url" rel="index"><span itemprop="name">notebook</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/notebook/machine-learning/" itemprop="url" rel="index"><span itemprop="name">machine-learning</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yjinheon.github.io/2023/10/28/machine-learning/notebook/machine-learning/xai/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/medium.jpg">
      <meta itemprop="name" content="JinHeon Yoon">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DataMind">
      <meta itemprop="description" content="my blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | DataMind">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/10/28/machine-learning/notebook/machine-learning/xai/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-10-28 00:53:30" itemprop="dateCreated datePublished" datetime="2023-10-28T00:53:30+09:00">2023-10-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-02-27 19:08:09" itemprop="dateModified" datetime="2023-02-27T19:08:09+09:00">2023-02-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/" itemprop="url" rel="index"><span itemprop="name">machine-learning</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/notebook/" itemprop="url" rel="index"><span itemprop="name">notebook</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/notebook/machine-learning/" itemprop="url" rel="index"><span itemprop="name">machine-learning</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yjinheon.github.io/2023/10/28/machine-learning/notebook/timeseries/TimeSeries/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/medium.jpg">
      <meta itemprop="name" content="JinHeon Yoon">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DataMind">
      <meta itemprop="description" content="my blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | DataMind">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/10/28/machine-learning/notebook/timeseries/TimeSeries/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-10-28 00:53:30" itemprop="dateCreated datePublished" datetime="2023-10-28T00:53:30+09:00">2023-10-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-02-27 19:08:09" itemprop="dateModified" datetime="2023-02-27T19:08:09+09:00">2023-02-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/" itemprop="url" rel="index"><span itemprop="name">machine-learning</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/notebook/" itemprop="url" rel="index"><span itemprop="name">notebook</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/notebook/timeseries/" itemprop="url" rel="index"><span itemprop="name">timeseries</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <!---
블로그 글 구분용


--->
<p>주요 개념</p>
<ul>
<li>시계열 분해<ul>
<li>추세</li>
<li>순환</li>
<li>계절성</li>
</ul>
</li>
<li>승법모형</li>
<li>가법모형</li>
</ul>
<h2 id="시계열-분해"><a href="#시계열-분해" class="headerlink" title="시계열 분해"></a>시계열 분해</h2><p>: 시계열 분해(Time Series Decompositon)</p>
<h3 id="추세-Trend"><a href="#추세-Trend" class="headerlink" title="추세 (Trend)"></a>추세 (Trend)</h3><h3 id="순환-Cycle"><a href="#순환-Cycle" class="headerlink" title="순환(Cycle)"></a>순환(Cycle)</h3><h3 id="계절성-Seasonality"><a href="#계절성-Seasonality" class="headerlink" title="계절성 (Seasonality)"></a>계절성 (Seasonality)</h3><h3 id="불규칙-변동-Irregular"><a href="#불규칙-변동-Irregular" class="headerlink" title="불규칙 변동(Irregular)"></a>불규칙 변동(Irregular)</h3><p>시계열</p>
<h2 id="시계열-모형"><a href="#시계열-모형" class="headerlink" title="시계열 모형"></a>시계열 모형</h2><h3 id="가법모형"><a href="#가법모형" class="headerlink" title="가법모형"></a>가법모형</h3><p>$y_t &#x3D; S_t+T_t+R_t + I_t$</p>
<h3 id="승법모형"><a href="#승법모형" class="headerlink" title="승법모형"></a>승법모형</h3><p>$y_t &#x3D; S_t * T_t*R_t * I_t$</p>
<h2 id="Refererences"><a href="#Refererences" class="headerlink" title="Refererences"></a>Refererences</h2><ul>
<li><a target="_blank" rel="noopener" href="https://otexts.com/fppkr/index.html">https://otexts.com/fppkr/index.html</a></li>
<li></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yjinheon.github.io/2023/10/28/machine-learning/notebook/visualization/Visualization/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/medium.jpg">
      <meta itemprop="name" content="JinHeon Yoon">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DataMind">
      <meta itemprop="description" content="my blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | DataMind">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/10/28/machine-learning/notebook/visualization/Visualization/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-10-28 00:53:30" itemprop="dateCreated datePublished" datetime="2023-10-28T00:53:30+09:00">2023-10-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-02-27 19:08:09" itemprop="dateModified" datetime="2023-02-27T19:08:09+09:00">2023-02-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/" itemprop="url" rel="index"><span itemprop="name">machine-learning</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/notebook/" itemprop="url" rel="index"><span itemprop="name">notebook</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/notebook/visualization/" itemprop="url" rel="index"><span itemprop="name">visualization</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="문서-분리-기준"><a href="#문서-분리-기준" class="headerlink" title="문서 분리 기준"></a>문서 분리 기준</h1><ul>
<li>H1 기준으로 문서 분리</li>
<li>번호 붙일 것</li>
</ul>
<h1 id="이-문서에-넣을-것들"><a href="#이-문서에-넣을-것들" class="headerlink" title="이 문서에 넣을 것들"></a>이 문서에 넣을 것들</h1><ul>
<li>시각화 코드 전부</li>
<li><h2 id="toobox에-visualization에도-전부-넣기"><a href="#toobox에-visualization에도-전부-넣기" class="headerlink" title="toobox에 visualization에도 전부 넣기"></a>toobox에 visualization에도 전부 넣기</h2></li>
</ul>
<p>EDA는 기본적으로 데이터를 처음 받았을 때 하는 일들이다.<br>데이터 전처리랑 겹치는 부분이 있다.<br>EDA는 시각화와 관련이 있다.</p>
<p>시각화는 분석전후에도 쓰인다.</p>
<p>여기에는 시각화 관련 전반적인 내용과 시각화 중심의 EDA를 기록한다,</p>
<p><strong>무지성카피</strong></p>
<h1 id="데이터를-보고나서-해야할-것"><a href="#데이터를-보고나서-해야할-것" class="headerlink" title="데이터를 보고나서 해야할 것"></a>데이터를 보고나서 해야할 것</h1><p><strong>long 형태로 바꿀 수 있는 데이터라면 반드시 long 형태로 바꾼다.</strong></p>
<h1 id="분석과정중의-시각화"><a href="#분석과정중의-시각화" class="headerlink" title="분석과정중의 시각화"></a>분석과정중의 시각화</h1><h2 id="사전작업"><a href="#사전작업" class="headerlink" title="사전작업"></a>사전작업</h2><h2 id="pandas-함수들-pandas-utility"><a href="#pandas-함수들-pandas-utility" class="headerlink" title="pandas 함수들 (pandas utility)"></a><strong>pandas 함수들 (pandas utility)</strong></h2><blockquote>
<p>주요 pandas 함수 기능 정리</p>
</blockquote>
<ul>
<li>shape : DF 차원 파악</li>
</ul>
<h4 id="Visualization-나중에-옮길것"><a href="#Visualization-나중에-옮길것" class="headerlink" title="Visualization(나중에 옮길것)"></a>Visualization(나중에 옮길것)</h4><ul>
<li>plot</li>
<li>plot.area</li>
<li>plot.bar</li>
<li>plot.barh</li>
<li>plot.box</li>
<li>plot.density</li>
<li>plot.hexbin</li>
<li>plot.hist</li>
<li>plot.kde</li>
<li>plot.line</li>
<li>plot.pie</li>
<li>plot.scatter</li>
</ul>
<h3 id="한글폰트-설정하기"><a href="#한글폰트-설정하기" class="headerlink" title="한글폰트 설정하기"></a>한글폰트 설정하기</h3><ul>
<li>한글폰트 시각화 관련</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 다른 노트북 작성할 때도 이 셀만 떼서 사용 가능하다.</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt </span><br><span class="line"><span class="keyword">import</span> platform                </span><br><span class="line"></span><br><span class="line"><span class="comment"># 웬만하면 해주는 것이 좋다.</span></span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> font_manager, rc</span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>]= <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> platform.system() == <span class="string">&#x27;Darwin&#x27;</span>: <span class="comment"># 맥os 사용자의 경우에</span></span><br><span class="line">    plt.style.use(<span class="string">&#x27;seaborn-darkgrid&#x27;</span>) </span><br><span class="line">    rc(<span class="string">&#x27;font&#x27;</span>, family = <span class="string">&#x27;AppleGothic&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">elif</span> platform.system() == <span class="string">&#x27;Windows&#x27;</span>:<span class="comment"># 윈도우 사용자의 경우에</span></span><br><span class="line">    path = <span class="string">&#x27;c:/Windows/Fonts/malgun.ttf&#x27;</span></span><br><span class="line">    font_name = font_manager.FontProperties(fname=path).get_name()</span><br><span class="line">    plt.style.use(<span class="string">&#x27;seaborn-darkgrid&#x27;</span>) <span class="comment"># https://python-graph-gallery.com/199-matplotlib-style-sheets/</span></span><br><span class="line">    rc(<span class="string">&#x27;font&#x27;</span>, family=font_name)</span><br></pre></td></tr></table></figure>

<ul>
<li>colab 한글폰트 시각화 관련</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">이후 런타임 재시작</span></span><br><span class="line">!sudo apt-get install -y fonts-nanum</span><br><span class="line">!sudo fc-cache -fv</span><br><span class="line">!rm ~/.cache/matplotlib -rf</span><br></pre></td></tr></table></figure>

<p>이후 폰트를 나눔폰트로 바꾼다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">plt.rc(<span class="string">&#x27;font&#x27;</span>, family=<span class="string">&#x27;NanumBarunGothic&#x27;</span>) </span><br></pre></td></tr></table></figure>

<h2 id="plotting"><a href="#plotting" class="headerlink" title="plotting"></a>plotting</h2><h2 id="x범주형-y"><a href="#x범주형-y" class="headerlink" title="x범주형 y"></a>x범주형 y</h2><h3 id="bar-chart"><a href="#bar-chart" class="headerlink" title="bar chart"></a>bar chart</h3><h3 id="correlation-plot"><a href="#correlation-plot" class="headerlink" title="correlation plot"></a>correlation plot</h3><h3 id="raincloudplot"><a href="#raincloudplot" class="headerlink" title="raincloudplot"></a>raincloudplot</h3><ul>
<li><strong>기본적으로 분포를 보기위한 차트</strong></li>
</ul>
<p><strong>tools</strong></p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://mjskay.github.io/ggdist/">https://mjskay.github.io/ggdist/</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/pog87/PtitPrince">https://github.com/pog87/PtitPrince</a> # 파이썬 버전</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/RainCloudPlots/RainCloudPlots">https://github.com/RainCloudPlots/RainCloudPlots</a></p>
</li>
<li><p>기본 베이스는 이거고 여기서 옵션 조절해가며 그릴 것</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">sns.<span class="built_in">set</span>(style=<span class="string">&quot;darkgrid&quot;</span>)</span><br><span class="line">sns.<span class="built_in">set</span>(style=<span class="string">&quot;whitegrid&quot;</span>)</span><br><span class="line">sns.set_style(<span class="string">&quot;white&quot;</span>)</span><br><span class="line">sns.<span class="built_in">set</span>(style=<span class="string">&quot;whitegrid&quot;</span>,font_scale=<span class="number">2</span>) <span class="comment"># 조절 가능</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.collections <span class="keyword">as</span> clt</span><br><span class="line"><span class="keyword">import</span> ptitprince <span class="keyword">as</span> pt <span class="comment"># raincloud function</span></span><br><span class="line"></span><br><span class="line">dx=<span class="string">&quot;group&quot;</span>; dy=<span class="string">&quot;score&quot;</span>; dhue = <span class="string">&quot;gr2&quot;</span>; ort=<span class="string">&quot;h&quot;</span>; pal = <span class="string">&quot;Set2&quot;</span>; sigma = <span class="number">.2</span></span><br><span class="line">f, ax = plt.subplots(figsize=(<span class="number">12</span>, <span class="number">5</span>)) <span class="comment"># 조절가능</span></span><br><span class="line"></span><br><span class="line">ax=pt.RainCloud(x = dx, y = dy, hue = dhue, data = df, palette = pal, bw = sigma, width_viol = <span class="number">.7</span>,</span><br><span class="line">                ax = ax, orient = ort , alpha = <span class="number">.65</span>, dodge = <span class="literal">True</span>, pointplot = <span class="literal">True</span>, move = <span class="number">.2</span>)</span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">&quot;Figure P18\n Shifting the Rain with the Move Parameter&quot;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="분석-이후의-시각화"><a href="#분석-이후의-시각화" class="headerlink" title="분석 이후의 시각화"></a>분석 이후의 시각화</h1><h2 id="예측"><a href="#예측" class="headerlink" title="예측"></a>예측</h2><h3 id="회귀-시각화"><a href="#회귀-시각화" class="headerlink" title="회귀 시각화"></a>회귀 시각화</h3><ul>
<li>신뢰구간을 포함한 단순선형회귀</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">sns.regplot(x=train[<span class="string">&#x27;GrLivArea&#x27;</span>], y=train[<span class="string">&#x27;SalePrice&#x27;</span>]).set_title(<span class="string">&#x27;Housing Prices&#x27;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>2d 선형회귀직선과 제곱오차(squared errors)를 확인하기 위한 함수.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> IPython.display <span class="keyword">import</span> display</span><br><span class="line"><span class="keyword">from</span> matplotlib.patches <span class="keyword">import</span> Rectangle</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">eval_metrics</span>(<span class="params">df, feature, target, slope, intercept</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    2d 선형회귀직선과 제곱오차(squared errors)를 확인하기 위한 함수</span></span><br><span class="line"><span class="string">    df : Pandas 데이터프레임</span></span><br><span class="line"><span class="string">    feature : 특징 열</span></span><br><span class="line"><span class="string">    target : 타겟 열</span></span><br><span class="line"><span class="string">    slope : 선형방정식의 기울기</span></span><br><span class="line"><span class="string">    intercept : 선형방정식의 y 절편</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    x = df[feature]</span><br><span class="line">    y = df[target]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># plot 데이터</span></span><br><span class="line">    ax = plt.axes()</span><br><span class="line">    df.plot.scatter(feature, target, ax=ax)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 예측</span></span><br><span class="line">    y_pred = slope * x + intercept</span><br><span class="line"></span><br><span class="line">    <span class="comment"># plot 예측</span></span><br><span class="line">    ax.plot(x, y_pred)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Plot 제곱오차(MSE)</span></span><br><span class="line">    x_left, x_right = ax.get_xlim() <span class="comment"># x-axis view limits</span></span><br><span class="line">    y_bottom, y_top = ax.get_ylim()</span><br><span class="line">    scale = (x_right - x_left) / (y_top - y_bottom)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> f, t, p <span class="keyword">in</span> <span class="built_in">zip</span>(x, y, y_pred):</span><br><span class="line">        xy = (f, <span class="built_in">min</span>(t, p))</span><br><span class="line">        h = <span class="built_in">abs</span>(t - p)</span><br><span class="line">        w_scaled = h * scale</span><br><span class="line">        ax.add_patch(Rectangle(xy=xy, width=w_scaled, height=h, alpha=<span class="number">0.2</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 회귀방정식 평가지표</span></span><br><span class="line">    mse = mean_squared_error(y, y_pred)</span><br><span class="line">    mae = mean_absolute_error(y, y_pred)</span><br><span class="line">    rmse = mse ** <span class="number">0.5</span></span><br><span class="line">    r2 = r2_score(y, y_pred)</span><br><span class="line"></span><br><span class="line">    display(pd.DataFrame([[<span class="string">&#x27;MSE&#x27;</span>, mse],[<span class="string">&#x27;MAE&#x27;</span>, mae],[<span class="string">&#x27;RMSE&#x27;</span>, rmse],[<span class="string">&#x27;R2&#x27;</span>, r2]], columns=[<span class="string">&#x27;Metric&#x27;</span>, <span class="string">&#x27;Score&#x27;</span>]))</span><br></pre></td></tr></table></figure>

<h2 id="트리"><a href="#트리" class="headerlink" title="트리"></a>트리</h2><h3 id="dtreeviz를-활용한-tree시각화"><a href="#dtreeviz를-활용한-tree시각화" class="headerlink" title="dtreeviz를 활용한 tree시각화"></a>dtreeviz를 활용한 tree시각화</h3><p>-<a target="_blank" rel="noopener" href="https://github.com/parrt/dtreeviz">깃허브 링크</a></p>
<p><strong>Code from TowardDS</strong></p>
<ul>
<li>setup</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_iris, load_boston</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> tree</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> dtreeviz.trees <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># load the two data sets  </span></span><br><span class="line">iris = load_iris()</span><br><span class="line">boston = load_boston()</span><br></pre></td></tr></table></figure>

<ul>
<li>old way</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># prepare the data</span></span><br><span class="line">X = iris.data</span><br><span class="line">y = iris.target</span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class="number">0.2</span>, random_state=<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># fit the classifier</span></span><br><span class="line">clf = tree.DecisionTreeClassifier(max_depth=<span class="number">3</span>, random_state=<span class="number">42</span>)</span><br><span class="line">clf.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">tree.plot_tree(clf); <span class="comment"># this old way</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Decision Tree의 Class Labeling (색칠하기)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tree.plot_tree(clf,</span><br><span class="line">               feature_names = iris.feature_names, </span><br><span class="line">               class_names=iris.target_names,</span><br><span class="line">               rounded=<span class="literal">True</span>, </span><br><span class="line">               filled = <span class="literal">True</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>dtreeviz in action</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">viz = dtreeviz(clf, </span><br><span class="line">               x_data=X_train,</span><br><span class="line">               y_data=y_train,</span><br><span class="line">               target_name=<span class="string">&#x27;class&#x27;</span>,</span><br><span class="line">               feature_names=iris.feature_names, </span><br><span class="line">               class_names=<span class="built_in">list</span>(iris.target_names), </span><br><span class="line">               title=<span class="string">&quot;Decision Tree - Iris data set&quot;</span>)</span><br><span class="line">viz</span><br></pre></td></tr></table></figure>

<p><img src="https://miro.medium.com/max/1050/1*iiYZWUlZyCvvNahmcVT1XA.png"></p>
<ul>
<li>highlight the path of first obervation of the test set</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">viz = dtreeviz(clf, </span><br><span class="line">               x_data=X_train,</span><br><span class="line">               y_data=y_train,</span><br><span class="line">               target_name=<span class="string">&#x27;class&#x27;</span>,</span><br><span class="line">               feature_names=iris.feature_names, </span><br><span class="line">               class_names=<span class="built_in">list</span>(iris.target_names),</span><br><span class="line">               title=<span class="string">&quot;Decision Tree - Iris data set&quot;</span>,</span><br><span class="line">               [[orientation]]=<span class="string">&quot;LR&quot;</span>, </span><br><span class="line">               X=X_test[<span class="number">0</span>])  </span><br><span class="line">viz</span><br></pre></td></tr></table></figure>

<ul>
<li>Regression example</li>
<li>회귀분석</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># prepare the data</span></span><br><span class="line">X = boston.data</span><br><span class="line">y = boston.target</span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class="number">0.2</span>, random_state=<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># fir the regressor</span></span><br><span class="line">reg = tree.DecisionTreeRegressor(max_depth=<span class="number">2</span>, random_state=<span class="number">42</span>)</span><br><span class="line">reg.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot the tree</span></span><br><span class="line">viz = dtreeviz(reg,</span><br><span class="line">               x_data=X_train,</span><br><span class="line">               y_data=y_train,</span><br><span class="line">               target_name=<span class="string">&#x27;price&#x27;</span>,</span><br><span class="line">               feature_names=boston.feature_names,</span><br><span class="line">               title=<span class="string">&quot;Decision Tree - Boston housing&quot;</span>,</span><br><span class="line">               show_node_labels = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://miro.medium.com/max/1050/1*XN54CVrnWqtn4GRs_ij2yQ.png"></p>
<h4 id="Regression-Tree"><a href="#Regression-Tree" class="headerlink" title="Regression_Tree"></a>Regression_Tree</h4><ul>
<li>Wine Dataset Regression Visualization</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">features = wine.drop(<span class="string">&#x27;quality&#x27;</span>,axis=<span class="number">1</span>)</span><br><span class="line">target = wine[<span class="string">&#x27;quality&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Regression tree on Wine data</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">25</span>,<span class="number">20</span>))</span><br><span class="line">regr= tree.DecisionTreeRegressor(max_depth=<span class="number">3</span>)  </span><br><span class="line">regr.fit(features, target)</span><br><span class="line">viz = dtreeviz(regr,</span><br><span class="line">               features,</span><br><span class="line">               target,</span><br><span class="line">               target_name=<span class="string">&#x27;wine quality&#x27;</span>,</span><br><span class="line">               feature_names=features.columns,</span><br><span class="line">               title=<span class="string">&quot;Wine data set regression&quot;</span>,</span><br><span class="line">               fontname=<span class="string">&quot;Arial&quot;</span>,</span><br><span class="line">               colors = &#123;<span class="string">&quot;title&quot;</span>:<span class="string">&quot;purple&quot;</span>&#125;,</span><br><span class="line">               scale=<span class="number">1.5</span>)</span><br><span class="line">viz</span><br></pre></td></tr></table></figure>

<p><img src="https://miro.medium.com/max/1050/1*qzLs2IBAYSEJwycZ0rc7mg.png"></p>
<h4 id="Classification-Tree"><a href="#Classification-Tree" class="headerlink" title="Classification_Tree"></a>Classification_Tree</h4><ul>
<li>Wine Dataset Classification Visualization</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">fig = plt.figure(figsize=(<span class="number">25</span>,<span class="number">20</span>))</span><br><span class="line">clf = tree.DecisionTreeClassifier(max_depth=<span class="number">3</span>)</span><br><span class="line">clf.fit(features, target)</span><br><span class="line"><span class="comment"># pick random X observation for demo</span></span><br><span class="line">X = features.iloc[np.random.randint(<span class="number">0</span>, <span class="built_in">len</span>(features)),:].values</span><br><span class="line">viz = dtreeviz(clf,</span><br><span class="line">               features,</span><br><span class="line">               target,</span><br><span class="line">               target_name=<span class="string">&#x27;wine quality&#x27;</span>,</span><br><span class="line">               feature_names=features.columns,</span><br><span class="line">               title=<span class="string">&quot;Wine data set classification&quot;</span>,</span><br><span class="line">               class_names=[<span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;3&#x27;</span>],</span><br><span class="line">               scale=<span class="number">1.3</span>,</span><br><span class="line">               X=X)</span><br><span class="line">viz</span><br></pre></td></tr></table></figure>

<h4 id="Prediction-Path"><a href="#Prediction-Path" class="headerlink" title="Prediction Path"></a>Prediction Path</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">regr = tree.DecisionTreeRegressor(max_depth=<span class="number">2</span>)  <span class="comment"># limit depth of tree</span></span><br><span class="line">diabetes = load_diabetes()</span><br><span class="line">regr.fit(diabetes.data, diabetes.target)</span><br><span class="line">X = diabetes.data[np.random.randint(<span class="number">0</span>, <span class="built_in">len</span>(diabetes.data)),:]  <span class="comment"># random sample from training</span></span><br><span class="line"></span><br><span class="line">viz = dtreeviz(regr,</span><br><span class="line">               diabetes.data, </span><br><span class="line">               diabetes.target, </span><br><span class="line">               target_name=<span class="string">&#x27;value&#x27;</span>, </span><br><span class="line">               orientation =<span class="string">&#x27;LR&#x27;</span>,  <span class="comment"># left-right orientation</span></span><br><span class="line">               feature_names=diabetes.feature_names,</span><br><span class="line">               X=X)  <span class="comment"># need to give single observation for prediction</span></span><br><span class="line"></span><br><span class="line">viz.view()  </span><br></pre></td></tr></table></figure>

<p>If you want to visualize just the prediction path, you need to set parameter show_just_path&#x3D;True</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">dtreeviz(regr,</span><br><span class="line">        diabetes.data, </span><br><span class="line">        diabetes.target, </span><br><span class="line">        target_name=<span class="string">&#x27;value&#x27;</span>, </span><br><span class="line">        orientation =<span class="string">&#x27;TD&#x27;</span>,  <span class="comment"># top-down orientation</span></span><br><span class="line">        feature_names=diabetes.feature_names,</span><br><span class="line">        X=X, <span class="comment"># need to give single observation for prediction</span></span><br><span class="line">        show_just_path=<span class="literal">True</span>     </span><br><span class="line">        )</span><br></pre></td></tr></table></figure>

<p><strong>Explain Prediction Path</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">X = dataset[features].iloc[<span class="number">10</span>]</span><br><span class="line"><span class="built_in">print</span>(X)</span><br><span class="line">Pclass              <span class="number">3.0</span></span><br><span class="line">Age                 <span class="number">4.0</span></span><br><span class="line">Fare               <span class="number">16.7</span></span><br><span class="line">Sex_label           <span class="number">0.0</span></span><br><span class="line">Cabin_label       <span class="number">145.0</span></span><br><span class="line">Embarked_label      <span class="number">2.0</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(explain_prediction_path(tree_classifier, X, feature_names=features, explanation_type=<span class="string">&quot;plain_english&quot;</span>))</span><br><span class="line"><span class="number">2.5</span> &lt;= Pclass </span><br><span class="line">Age &lt; <span class="number">36.5</span></span><br><span class="line">Fare &lt; <span class="number">23.35</span></span><br><span class="line">Sex_label &lt; <span class="number">0.5</span></span><br></pre></td></tr></table></figure>

<h4 id="Regression-with-univariate-feature-target-space"><a href="#Regression-with-univariate-feature-target-space" class="headerlink" title="Regression with univariate feature-target space"></a>Regression with univariate feature-target space</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeRegressor</span><br><span class="line"><span class="keyword">from</span> dtreeviz.trees <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">df_cars = pd.read_csv(<span class="string">&quot;cars.csv&quot;</span>)</span><br><span class="line">X, y = df_cars[[<span class="string">&#x27;WGT&#x27;</span>]], df_cars[<span class="string">&#x27;MPG&#x27;</span>]</span><br><span class="line"></span><br><span class="line">dt = DecisionTreeRegressor(max_depth=<span class="number">3</span>, criterion=<span class="string">&quot;mae&quot;</span>)</span><br><span class="line">dt.fit(X, y)</span><br><span class="line"></span><br><span class="line">fig = plt.figure()</span><br><span class="line">ax = fig.gca()</span><br><span class="line">rtreeviz_univar(dt, X, y, <span class="string">&#x27;WGT&#x27;</span>, <span class="string">&#x27;MPG&#x27;</span>, ax=ax)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="https://user-images.githubusercontent.com/178777/49105092-9b264d80-f234-11e8-9d67-cc58c47016ca.png"></p>
<h4 id="Regression-bivariate-feature-target-space"><a href="#Regression-bivariate-feature-target-space" class="headerlink" title="Regression bivariate feature-target space"></a>Regression bivariate feature-target space</h4><img src="https://user-images.githubusercontent.com/178777/49104999-4edb0d80-f234-11e8-9010-73b7c0ba5fb9.png" width="30%">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeRegressor</span><br><span class="line"><span class="keyword">from</span> dtreeviz.trees <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">df_cars = pd.read_csv(<span class="string">&quot;cars.csv&quot;</span>)</span><br><span class="line">X = df_cars[[<span class="string">&#x27;WGT&#x27;</span>,<span class="string">&#x27;ENG&#x27;</span>]]</span><br><span class="line">y = df_cars[<span class="string">&#x27;MPG&#x27;</span>]</span><br><span class="line"></span><br><span class="line">dt = DecisionTreeRegressor(max_depth=<span class="number">3</span>, criterion=<span class="string">&quot;mae&quot;</span>)</span><br><span class="line">dt.fit(X, y)</span><br><span class="line"></span><br><span class="line">figsize = (<span class="number">6</span>,<span class="number">5</span>)</span><br><span class="line">fig = plt.figure(figsize=figsize)</span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>, projection=<span class="string">&#x27;3d&#x27;</span>)</span><br><span class="line"></span><br><span class="line">t = rtreeviz_bivar_3D(dt,</span><br><span class="line">                      X, y,</span><br><span class="line">                      feature_names=[<span class="string">&#x27;Vehicle Weight&#x27;</span>, <span class="string">&#x27;Horse Power&#x27;</span>],</span><br><span class="line">                      target_name=<span class="string">&#x27;MPG&#x27;</span>,</span><br><span class="line">                      fontsize=<span class="number">14</span>,</span><br><span class="line">                      elev=<span class="number">20</span>,</span><br><span class="line">                      azim=<span class="number">25</span>,</span><br><span class="line">                      dist=<span class="number">8.2</span>,</span><br><span class="line">                      show=&#123;<span class="string">&#x27;splits&#x27;</span>,<span class="string">&#x27;title&#x27;</span>&#125;,</span><br><span class="line">                      ax=ax)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<h4 id="Regression-bivariate-feature-target-space-heatmap"><a href="#Regression-bivariate-feature-target-space-heatmap" class="headerlink" title="Regression bivariate feature-target space heatmap"></a>Regression bivariate feature-target space heatmap</h4><img src="https://user-images.githubusercontent.com/178777/49107627-08d57800-f23b-11e8-85a2-ab5894055092.png" width="30%">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeRegressor</span><br><span class="line"><span class="keyword">from</span> dtreeviz.trees <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">df_cars = pd.read_csv(<span class="string">&quot;cars.csv&quot;</span>)</span><br><span class="line">X = df_cars[[<span class="string">&#x27;WGT&#x27;</span>,<span class="string">&#x27;ENG&#x27;</span>]]</span><br><span class="line">y = df_cars[<span class="string">&#x27;MPG&#x27;</span>]</span><br><span class="line"></span><br><span class="line">dt = DecisionTreeRegressor(max_depth=<span class="number">3</span>, criterion=<span class="string">&quot;mae&quot;</span>)</span><br><span class="line">dt.fit(X, y)</span><br><span class="line"></span><br><span class="line">t = rtreeviz_bivar_heatmap(dt,</span><br><span class="line">                           X, y,</span><br><span class="line">                           feature_names=[<span class="string">&#x27;Vehicle Weight&#x27;</span>, <span class="string">&#x27;Horse Power&#x27;</span>],</span><br><span class="line">                           fontsize=<span class="number">14</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</p>
<p>Highlights the decision nodes in which the feature value of single observation passed in argument X falls. Gives feature values of the observation and highlights features which are used by tree to traverse path.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">regr = tree.DecisionTreeRegressor(max_depth=<span class="number">2</span>)  <span class="comment"># limit depth of tree</span></span><br><span class="line">diabetes = load_diabetes()</span><br><span class="line">regr.fit(diabetes.data, diabetes.target)</span><br><span class="line">X = diabetes.data[np.random.randint(<span class="number">0</span>, <span class="built_in">len</span>(diabetes.data)),:]  <span class="comment"># random sample from training</span></span><br><span class="line"></span><br><span class="line">viz = dtreeviz(regr,</span><br><span class="line">               diabetes.data, </span><br><span class="line">               diabetes.target, </span><br><span class="line">               target_name=<span class="string">&#x27;value&#x27;</span>, </span><br><span class="line">               orientation =<span class="string">&#x27;LR&#x27;</span>,  <span class="comment"># left-right orientation</span></span><br><span class="line">               feature_names=diabetes.feature_names,</span><br><span class="line">               X=X)  <span class="comment"># need to give single observation for prediction</span></span><br><span class="line"></span><br><span class="line">viz.view()  </span><br></pre></td></tr></table></figure>

<p>If you want to visualize just the prediction path, you need to set parameter show_just_path&#x3D;True</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">dtreeviz(regr,</span><br><span class="line">        diabetes.data, </span><br><span class="line">        diabetes.target, </span><br><span class="line">        target_name=<span class="string">&#x27;value&#x27;</span>, </span><br><span class="line">        orientation =<span class="string">&#x27;TD&#x27;</span>,  <span class="comment"># top-down orientation</span></span><br><span class="line">        feature_names=diabetes.feature_names,</span><br><span class="line">        X=X, <span class="comment"># need to give single observation for prediction</span></span><br><span class="line">        show_just_path=<span class="literal">True</span>     </span><br><span class="line">        )</span><br></pre></td></tr></table></figure>

<p><strong>Explain Prediction Path</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">X = dataset[features].iloc[<span class="number">10</span>]</span><br><span class="line"><span class="built_in">print</span>(X)</span><br><span class="line">Pclass              <span class="number">3.0</span></span><br><span class="line">Age                 <span class="number">4.0</span></span><br><span class="line">Fare               <span class="number">16.7</span></span><br><span class="line">Sex_label           <span class="number">0.0</span></span><br><span class="line">Cabin_label       <span class="number">145.0</span></span><br><span class="line">Embarked_label      <span class="number">2.0</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(explain_prediction_path(tree_classifier, X, feature_names=features, explanation_type=<span class="string">&quot;plain_english&quot;</span>))</span><br><span class="line"><span class="number">2.5</span> &lt;= Pclass </span><br><span class="line">Age &lt; <span class="number">36.5</span></span><br><span class="line">Fare &lt; <span class="number">23.35</span></span><br><span class="line">Sex_label &lt; <span class="number">0.5</span></span><br></pre></td></tr></table></figure>

<h4 id="Regression-with-univariate-feature-target-space-1"><a href="#Regression-with-univariate-feature-target-space-1" class="headerlink" title="Regression with univariate feature-target space"></a>Regression with univariate feature-target space</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeRegressor</span><br><span class="line"><span class="keyword">from</span> dtreeviz.trees <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">df_cars = pd.read_csv(<span class="string">&quot;cars.csv&quot;</span>)</span><br><span class="line">X, y = df_cars[[<span class="string">&#x27;WGT&#x27;</span>]], df_cars[<span class="string">&#x27;MPG&#x27;</span>]</span><br><span class="line"></span><br><span class="line">dt = DecisionTreeRegressor(max_depth=<span class="number">3</span>, criterion=<span class="string">&quot;mae&quot;</span>)</span><br><span class="line">dt.fit(X, y)</span><br><span class="line"></span><br><span class="line">fig = plt.figure()</span><br><span class="line">ax = fig.gca()</span><br><span class="line">rtreeviz_univar(dt, X, y, <span class="string">&#x27;WGT&#x27;</span>, <span class="string">&#x27;MPG&#x27;</span>, ax=ax)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="https://user-images.githubusercontent.com/178777/49105092-9b264d80-f234-11e8-9d67-cc58c47016ca.png"></p>
<h4 id="Regression-bivariate-feature-target-space-1"><a href="#Regression-bivariate-feature-target-space-1" class="headerlink" title="Regression bivariate feature-target space"></a>Regression bivariate feature-target space</h4><img src="https://user-images.githubusercontent.com/178777/49104999-4edb0d80-f234-11e8-9010-73b7c0ba5fb9.png" width="30%">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeRegressor</span><br><span class="line"><span class="keyword">from</span> dtreeviz.trees <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">df_cars = pd.read_csv(<span class="string">&quot;cars.csv&quot;</span>)</span><br><span class="line">X = df_cars[[<span class="string">&#x27;WGT&#x27;</span>,<span class="string">&#x27;ENG&#x27;</span>]]</span><br><span class="line">y = df_cars[<span class="string">&#x27;MPG&#x27;</span>]</span><br><span class="line"></span><br><span class="line">dt = DecisionTreeRegressor(max_depth=<span class="number">3</span>, criterion=<span class="string">&quot;mae&quot;</span>)</span><br><span class="line">dt.fit(X, y)</span><br><span class="line"></span><br><span class="line">figsize = (<span class="number">6</span>,<span class="number">5</span>)</span><br><span class="line">fig = plt.figure(figsize=figsize)</span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>, projection=<span class="string">&#x27;3d&#x27;</span>)</span><br><span class="line"></span><br><span class="line">t = rtreeviz_bivar_3D(dt,</span><br><span class="line">                      X, y,</span><br><span class="line">                      feature_names=[<span class="string">&#x27;Vehicle Weight&#x27;</span>, <span class="string">&#x27;Horse Power&#x27;</span>],</span><br><span class="line">                      target_name=<span class="string">&#x27;MPG&#x27;</span>,</span><br><span class="line">                      fontsize=<span class="number">14</span>,</span><br><span class="line">                      elev=<span class="number">20</span>,</span><br><span class="line">                      azim=<span class="number">25</span>,</span><br><span class="line">                      dist=<span class="number">8.2</span>,</span><br><span class="line">                      show=&#123;<span class="string">&#x27;splits&#x27;</span>,<span class="string">&#x27;title&#x27;</span>&#125;,</span><br><span class="line">                      ax=ax)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<h4 id="Regression-bivariate-feature-target-space-heatmap-1"><a href="#Regression-bivariate-feature-target-space-heatmap-1" class="headerlink" title="Regression bivariate feature-target space heatmap"></a>Regression bivariate feature-target space heatmap</h4><img src="https://user-images.githubusercontent.com/178777/49107627-08d57800-f23b-11e8-85a2-ab5894055092.png" width="30%">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeRegressor</span><br><span class="line"><span class="keyword">from</span> dtreeviz.trees <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">df_cars = pd.read_csv(<span class="string">&quot;cars.csv&quot;</span>)</span><br><span class="line">X = df_cars[[<span class="string">&#x27;WGT&#x27;</span>,<span class="string">&#x27;ENG&#x27;</span>]]</span><br><span class="line">y = df_cars[<span class="string">&#x27;MPG&#x27;</span>]</span><br><span class="line"></span><br><span class="line">dt = DecisionTreeRegressor(max_depth=<span class="number">3</span>, criterion=<span class="string">&quot;mae&quot;</span>)</span><br><span class="line">dt.fit(X, y)</span><br><span class="line"></span><br><span class="line">t = rtreeviz_bivar_heatmap(dt,</span><br><span class="line">                           X, y,</span><br><span class="line">                           feature_names=[<span class="string">&#x27;Vehicle Weight&#x27;</span>, <span class="string">&#x27;Horse Power&#x27;</span>],</span><br><span class="line">                           fontsize=<span class="number">14</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>2392348623ab026ecc187a8b50d9619895c682ae</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<h4 id="Classification-univariate-feature-target-space"><a href="#Classification-univariate-feature-target-space" class="headerlink" title="Classification univariate feature-target space"></a>Classification univariate feature-target space</h4><img src="https://user-images.githubusercontent.com/178777/49105084-9497d600-f234-11e8-9097-56835558c1a6.png" width="30%">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"><span class="keyword">from</span> dtreeviz.trees <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">know = pd.read_csv(<span class="string">&quot;knowledge.csv&quot;</span>)</span><br><span class="line">class_names = [<span class="string">&#x27;very_low&#x27;</span>, <span class="string">&#x27;Low&#x27;</span>, <span class="string">&#x27;Middle&#x27;</span>, <span class="string">&#x27;High&#x27;</span>]</span><br><span class="line">know[<span class="string">&#x27;UNS&#x27;</span>] = know[<span class="string">&#x27;UNS&#x27;</span>].<span class="built_in">map</span>(&#123;n: i <span class="keyword">for</span> i, n <span class="keyword">in</span> <span class="built_in">enumerate</span>(class_names)&#125;)</span><br><span class="line"></span><br><span class="line">X = know[[<span class="string">&#x27;PEG&#x27;</span>]]</span><br><span class="line">y = know[<span class="string">&#x27;UNS&#x27;</span>]</span><br><span class="line"></span><br><span class="line">dt = DecisionTreeClassifier(max_depth=<span class="number">3</span>)</span><br><span class="line">dt.fit(X, y)</span><br><span class="line"></span><br><span class="line">ct = ctreeviz_univar(dt, X, y,</span><br><span class="line">                     feature_names = [<span class="string">&#x27;PEG&#x27;</span>],</span><br><span class="line">                     class_names=class_names,</span><br><span class="line">                     target_name=<span class="string">&#x27;Knowledge&#x27;</span>,</span><br><span class="line">                     nbins=<span class="number">40</span>, gtype=<span class="string">&#x27;strip&#x27;</span>,</span><br><span class="line">                     show=&#123;<span class="string">&#x27;splits&#x27;</span>,<span class="string">&#x27;title&#x27;</span>&#125;)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<h4 id="Classification-bivariate-feature-target-space"><a href="#Classification-bivariate-feature-target-space" class="headerlink" title="Classification bivariate feature-target space"></a>Classification bivariate feature-target space</h4><img src="https://user-images.githubusercontent.com/178777/49105085-9792c680-f234-11e8-8af5-bc2fde950ab1.png" width="30%">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"><span class="keyword">from</span> dtreeviz.trees <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">know = pd.read_csv(<span class="string">&quot;knowledge.csv&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(know)</span><br><span class="line">class_names = [<span class="string">&#x27;very_low&#x27;</span>, <span class="string">&#x27;Low&#x27;</span>, <span class="string">&#x27;Middle&#x27;</span>, <span class="string">&#x27;High&#x27;</span>]</span><br><span class="line">know[<span class="string">&#x27;UNS&#x27;</span>] = know[<span class="string">&#x27;UNS&#x27;</span>].<span class="built_in">map</span>(&#123;n: i <span class="keyword">for</span> i, n <span class="keyword">in</span> <span class="built_in">enumerate</span>(class_names)&#125;)</span><br><span class="line"></span><br><span class="line">X = know[[<span class="string">&#x27;PEG&#x27;</span>,<span class="string">&#x27;LPR&#x27;</span>]]</span><br><span class="line">y = know[<span class="string">&#x27;UNS&#x27;</span>]</span><br><span class="line"></span><br><span class="line">dt = DecisionTreeClassifier(max_depth=<span class="number">3</span>)</span><br><span class="line">dt.fit(X, y)</span><br><span class="line"></span><br><span class="line">ct = ctreeviz_bivar(dt, X, y,</span><br><span class="line">                    feature_names = [<span class="string">&#x27;PEG&#x27;</span>,<span class="string">&#x27;LPR&#x27;</span>],</span><br><span class="line">                    class_names=class_names,</span><br><span class="line">                    target_name=<span class="string">&#x27;Knowledge&#x27;</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<h4 id="Classification-boundaries-in-feature-space"><a href="#Classification-boundaries-in-feature-space" class="headerlink" title="Classification boundaries in feature space"></a>Classification boundaries in feature space</h4><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/parrt/dtreeviz/blob/master/README.md">https://github.com/parrt/dtreeviz/blob/master/README.md</a></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clfviz(rf, X, y, feature_names=[<span class="string">&#x27;x1&#x27;</span>, <span class="string">&#x27;x2&#x27;</span>], markers=[<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27;X&#x27;</span>,<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;D&#x27;</span>], target_name=<span class="string">&#x27;smiley&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://user-images.githubusercontent.com/178777/113516349-a12c4780-952e-11eb-86f3-0ae457eb500f.png"></p>
<h2 id="XAI"><a href="#XAI" class="headerlink" title="XAI"></a>XAI</h2><h1 id="그래프-관련-이슈들"><a href="#그래프-관련-이슈들" class="headerlink" title="그래프 관련 이슈들"></a>그래프 관련 이슈들</h1><h2 id="컬러-팔레트"><a href="#컬러-팔레트" class="headerlink" title="컬러 팔레트"></a>컬러 팔레트</h2><ul>
<li><p><a target="_blank" rel="noopener" href="https://blog.datawrapper.de/which-color-scale-to-use-in-data-vis/">https://blog.datawrapper.de/which-color-scale-to-use-in-data-vis/</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://seaborn.pydata.org/tutorial/color_palettes.html">https://seaborn.pydata.org/tutorial/color_palettes.html</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.omnisci.com/blog/12-color-palettes-for-telling-better-stories-with-your-data">https://www.omnisci.com/blog/12-color-palettes-for-telling-better-stories-with-your-data</a></p>
</li>
<li><p>차트에 컬러 팔렛 적용하기</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">  </span><br></pre></td></tr></table></figure></li>
</ul>
<p>import seaborn as sns<br>import matplotlib.pyplot as plt</p>
<p>five_thirty_eight &#x3D; [<br>    “#30a2da”,<br>    “#fc4f30”,<br>    “#e5ae38”,<br>    “#6d904f”,<br>    “#8b8b8b”,<br>]</p>
<p>sns.set_palette(five_thirty_eight)<br>sns.palplot(sns.color_palette())<br>plt.show(</p>
<h3 id="Categorical-Palettes"><a href="#Categorical-Palettes" class="headerlink" title="Categorical Palettes"></a>Categorical Palettes</h3><h3 id="Sequential-Palettes"><a href="#Sequential-Palettes" class="headerlink" title="Sequential Palettes"></a>Sequential Palettes</h3><h3 id="Diverging-Palettes"><a href="#Diverging-Palettes" class="headerlink" title="Diverging Palettes"></a>Diverging Palettes</h3><h2 id="축-이슈"><a href="#축-이슈" class="headerlink" title="축 이슈"></a>축 이슈</h2><h3 id="축에-있는-label-겹칠경우-overlapping-해결법-seaborn"><a href="#축에-있는-label-겹칠경우-overlapping-해결법-seaborn" class="headerlink" title="축에 있는 label 겹칠경우(overlapping) 해결법(seaborn)"></a>축에 있는 label 겹칠경우(overlapping) 해결법(seaborn)</h3><p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/42528921/how-to-prevent-overlapping-x-axis-labels-in-sns-countplot">https://stackoverflow.com/questions/42528921/how-to-prevent-overlapping-x-axis-labels-in-sns-countplot</a></p>
<pre><code>
</code></pre>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yjinheon.github.io/2023/10/28/machine-learning/notebook/visualization/mpl-seaborn/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/medium.jpg">
      <meta itemprop="name" content="JinHeon Yoon">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DataMind">
      <meta itemprop="description" content="my blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | DataMind">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/10/28/machine-learning/notebook/visualization/mpl-seaborn/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-10-28 00:53:30" itemprop="dateCreated datePublished" datetime="2023-10-28T00:53:30+09:00">2023-10-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-02-27 19:08:09" itemprop="dateModified" datetime="2023-02-27T19:08:09+09:00">2023-02-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/" itemprop="url" rel="index"><span itemprop="name">machine-learning</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/notebook/" itemprop="url" rel="index"><span itemprop="name">notebook</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/machine-learning/notebook/visualization/" itemprop="url" rel="index"><span itemprop="name">visualization</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://yjinheon.github.io/2022/03/02/machine-learning/NLP-wordembedding/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/medium.jpg">
      <meta itemprop="name" content="JinHeon Yoon">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DataMind">
      <meta itemprop="description" content="my blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | DataMind">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/03/02/machine-learning/NLP-wordembedding/" class="post-title-link" itemprop="url">[NLP]Word Embedding과 Text Classification</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-03-02 19:28:01" itemprop="dateCreated datePublished" datetime="2022-03-02T19:28:01+09:00">2022-03-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-04-15 07:10:22" itemprop="dateModified" datetime="2022-04-15T07:10:22+09:00">2022-04-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/NLP/" itemprop="url" rel="index"><span itemprop="name">NLP</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <!--

<center>Kaggle Customer Score Dataset</center>

- Machine Learning
- Statistics , Math
- Data Engineering
- Programming
- EDA & Visualization
- Data Extraction & Wrangling


#신경망이란 무엇인가?

https://www.youtube.com/watch?v=aircAruvnKk


#참고

https://cinema4dr12.tistory.com/1016?category=515283

https://www.kdnuggets.com/2021/07/top-python-data-science-interview-questions.html
-->

<h1 id="NLP-subtask에-대한-정리"><a href="#NLP-subtask에-대한-정리" class="headerlink" title="NLP subtask에 대한 정리"></a>NLP subtask에 대한 정리</h1><p>: 주요 NLP task인 Word Embedding과 Text Classfication에 대해 간단히 정리</p>
<h2 id="1-Word-Embedding"><a href="#1-Word-Embedding" class="headerlink" title="1.Word Embedding"></a>1.Word Embedding</h2><h3 id="1-1-Word-Embedding에서-고려하는-task"><a href="#1-1-Word-Embedding에서-고려하는-task" class="headerlink" title="1.1 Word Embedding에서 고려하는 task"></a>1.1 Word Embedding에서 고려하는 task</h3><p>Word Embedding은 단어를 저차원의 실수벡터로 dense mapping하는 word representation 방식의 하나이다.</p>
<p>Embedding 자체는 토큰을 고정된 길이의 벡터로 표현하는 것을 뜻한다.</p>
<p><strong>단어의 구문(Syntax)와 의미(Semantics)를 실수벡터의 형태로 표현하는 것이 그 목적이다.</strong></p>
<p><img src="https://miro.medium.com/max/1050/1*lzjgo2KaWFRPkV3LCJDr7Q.png"></p>
<h4 id="1-1-1-차원의-저주"><a href="#1-1-1-차원의-저주" class="headerlink" title="1.1.1 차원의 저주"></a>1.1.1 차원의 저주</h4><p>단어를 실수벡터의 형태로 dense mapping하는 이유는 차원의 저주를 피하기 위함이다.</p>
<p>문서의 모든 단어를 One Hot encoding으로 표현할 경우 feature가 기하급수적으로 많아진 희소행렬이 생성되고 이 경우 연산비용이 증가하는 문제점이 발생한다.</p>
<p>이를 피하기 위해 Word Embedding을 통해 단어를 저차원 벡터에 고정시켜 나타내게 된다.</p>
<h4 id="1-1-2-Distribution-Hypothesis"><a href="#1-1-2-Distribution-Hypothesis" class="headerlink" title="1.1.2 Distribution Hypothesis"></a>1.1.2 Distribution Hypothesis</h4><p>Distribution Hypothesis는 비슷한 위치에서 등장하는 단어들은 비슷한 의미를 가진다는 가설이다.</p>
<p>Word embedding은 이 분포 가설에 기반하여 주변 단어 분포를 기준으로 타겟이 되는 단어의 벡터 표현을 결정한다. </p>
<p>따라서 Word Embedding을 통해 생성된 두 단어 벡터의 거리가 가까울 수록 원문에서 두 단어가 유사한 의미와 용법을 가졌다고 볼 수 있다.</p>
<h4 id="1-1-3-Predictive-Method"><a href="#1-1-3-Predictive-Method" class="headerlink" title="1.1.3 Predictive Method"></a>1.1.3 Predictive Method</h4><p>Word Embedding은 기본적으로 단어의 예측을 학습하는 것으로 이루어진다.</p>
<h3 id="1-2-대표적인-데이터셋"><a href="#1-2-대표적인-데이터셋" class="headerlink" title="1.2 대표적인 데이터셋"></a>1.2 대표적인 데이터셋</h3><h4 id="Words-in-Context"><a href="#Words-in-Context" class="headerlink" title="Words in Context"></a>Words in Context</h4><p>Word in Context는 문맥에 따른 단어의 용법을 모아놓은 데이터 셋이다.</p>
<p>과거의 Word Embedding 기법들이 문맥에 따라 달라지는 단어의 의미를 구분하지 못한다는 문제점을 보완하기 위해 만들어졌다.</p>
<p>Word in Context을 통해 문맥정보를 학습한 임베딩을 생성할 수 있다.</p>
<p>데이터셋은 타겟단어 , 타겟이 되는 타겟단어의 Context 문장 2개와 해당 문장이 문맥상 같은 의미로 쓰여졌는지에 대한 label로 구성되어 있다.</p>
<p><img src="https://images.velog.io/images/yjinheon/post/b44f7201-b8ac-4c98-9646-510f7b2ef6a3/Velog_1_10.png"></p>
<h3 id="Contextual-Embedding-SOTA-Technique"><a href="#Contextual-Embedding-SOTA-Technique" class="headerlink" title="Contextual Embedding(SOTA Technique)"></a>Contextual Embedding(SOTA Technique)</h3><p>Word Embedding은 기본적으로 모델링이 아니라 NLP task의 input을 만드는 작업이기 때문에  BERT, ELMO, GPT-1와 같은 SOTA 모델에서 사용하는 Embedding 방식인 Contextual Embedding에 대해 기술하고자 한다.</p>
<p>과거의 Word Embedding 대표적인 문제점은 하나의 단어당 하나의 벡터 값 만이 매핑된다는 것이다. 따라서 단어의 문맥에 따라 달라지는 의미를 고려하기 어려워지고 성능에 부적인 영향을 주게 된다.</p>
<p>이러한 문제점을 보완하기 위해 Deep contextualized word representations(ELMO)에서 Contextual Embedding이 제시되었다.</p>
<h4 id="biLM-bidirectional-Language-Model-as-function"><a href="#biLM-bidirectional-Language-Model-as-function" class="headerlink" title="biLM(bidirectional Language Model) as function"></a>biLM(bidirectional Language Model) as function</h4><p>Contextual Embedding과 기존 임베딩의 차이점은 각 단어마다 고정된 크기의 벡터를 사용한 것이 아니라 pretrained model 자체를 일종의 함수으로 기능하게끔 하여 문맥정보를 학습에 반영한다는 것이다.</p>
<p>ELMo(Embedding from Language Model)는 여기서 단순한 Language Model이 아니라 일종의 함수이며 문장에 따라 같은 단어라도 다른 임베딩(단어 벡터)을 출력할 수 있다.</p>
<p>여기서 biLM은 단순히 forword LSTM(앞의 단어들로 뒤에 나올 단어를 예측)과 backword LSTM(뒤의 단어들로 앞의 단어를 예픅)을 합친 양방향 모델을 말하며 ELmo의 학습에 사용된다.</p>
<h2 id="Text-Classification"><a href="#Text-Classification" class="headerlink" title="Text Classification"></a>Text Classification</h2><h3 id="Text-Classification의-주요-task"><a href="#Text-Classification의-주요-task" class="headerlink" title="Text Classification의 주요 task"></a>Text Classification의 주요 task</h3><p>Text Classification은 문서의 내용을 바탕으로 특징을 추출해서 특정한 카테고리에 분류하는 것을 그 목적으로 한다.</p>
<h3 id="대표적인-데이터셋"><a href="#대표적인-데이터셋" class="headerlink" title="대표적인 데이터셋"></a>대표적인 데이터셋</h3><h4 id="IMDB-Movie-Review"><a href="#IMDB-Movie-Review" class="headerlink" title="IMDB Movie Review"></a>IMDB Movie Review</h4><p>IMDB에 게시된 영화 리뷰와 Positive&#x2F;Negative label로 구성된 데이터셋이며 주로 감성분석과 추천시스템 구현에 사용된다.</p>
<h3 id="BERT-SOTA-Technique"><a href="#BERT-SOTA-Technique" class="headerlink" title="BERT(SOTA Technique)"></a>BERT(SOTA Technique)</h3><p>BERT는 구글에서 개발한 신경망 구조이며 Text Classification 뿐 만 아니라 질의응답, 기계번역 , 문서요약과 같은 다양한 task에 적용할 수 있는 대표적인 SOTA Model이다.</p>
<h4 id="Transformer"><a href="#Transformer" class="headerlink" title="Transformer"></a>Transformer</h4><ul>
<li>Transformer는 Encoder Decoder 구조를 가지는 딥러닝 모델이다.</li>
<li>기본적으로 여러개의 Encoder Decoder Layer가 존재하기 때문에 순차적으로 단어정보를 입력받지 않아 연산에서의 부담이 상대적으로 적은 편이다.</li>
<li>Encoder 내부에서는 self attention 기법으로 한 문장에서 한 단어가 다른 단어와 어떤 관계를 갖고 있는지 수치화한다.</li>
<li>문장의 Context를 학습하기 위해 Positional Encoding이라는 특수한 Input을 사용한다.<ul>
<li>Positional Encoding 을 통해 input으로 주어지는 단어의 vector안에 단어의 위치정보를 포함시킬 수 있다.</li>
</ul>
</li>
<li>BERT(Bidirectional Encoder Representations from Transformers)는 양방향 입력을 받는 Encoder를 여러개 쌓아올린 구조로 이루어져 있다.</li>
</ul>
<p>BERT에서는 일부 단어를 마스킹하고 해당 단어를 예측하거나(Masked L). 문장단위로 예측을 수행하는 기법(Next Sentence Prediction)</p>
<p>단어 토큰을 보다 세분화하는 WordPiece 기법을 사용한다.</p>
<h4 id="fine-tuning"><a href="#fine-tuning" class="headerlink" title="fine tuning"></a>fine tuning</h4><p>Transformer와 함께 BERT의 핵심 컨셉중 하나로 <em>기존의 학습된 모델을 기반으로 레이어를 새로운 task에 맞게 변형하고 이미 학습된 모델가중치를 업데이트하거나 모델의 파라미터를 재조정하는 것</em>을 뜻한다.</p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a target="_blank" rel="noopener" href="https://machinelearningmastery.com/what-are-word-embeddings/">https://machinelearningmastery.com/what-are-word-embeddings/</a></li>
<li><a target="_blank" rel="noopener" href="https://pilehvar.github.io/wic/">https://pilehvar.github.io/wic/</a></li>
<li><a target="_blank" rel="noopener" href="https://arxiv.org/pdf/1808.09121v3.pdf">WiC: the Word-in-Context Dataset</a></li>
<li><a target="_blank" rel="noopener" href="https://arxiv.org/pdf/1802.05365.pdf">Deep contextualized word representations</a></li>
<li><a target="_blank" rel="noopener" href="https://paperswithcode.com/method/elmo">https://paperswithcode.com/method/elmo</a></li>
<li><a target="_blank" rel="noopener" href="https://skyjwoo.tistory.com/entry/positional-encoding%EC%9D%B4%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80">Positional Encoding의 이해</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/blog/page/7/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/blog/">1</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/blog/page/9/">9</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/11/">11</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/blog/page/9/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">JinHeon Yoon</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/yjinheon" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>


  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/9.4.0/mermaid.min.js","integrity":"sha256-3JloMMI/ZQx6ryuhhZTsQJQmGAkXeni6PkshX7UUO2s="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>


  <script src="/js/third-party/pace.js"></script>

  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



<!-- hexo injector body_end start --><script src="/js/hexo-widget-tree.js"></script><div id="widget-tree">
      <ul>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/backend/">
          backend
        </a>
      <span class="tree-list-count">6</span><ul class="tree-list-children">
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/backend/FastAPI/">
          FastAPI
        </a>
      <span class="tree-list-count">2</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/11/12/backend/back-FastApi-Pydantic/" title="[FastAPI]Pydantic  데이터 업데이트"><i class="post-icon gg-file-document"></i>[FastAPI]Pydantic  데이터 업데이트</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/12/30/backend/fastapi/back-fastapi-index/" title="[FastAPI]Index"><i class="post-icon gg-file-document"></i>[FastAPI]Index</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/backend/Spring/">
          Spring
        </a>
      <span class="tree-list-count">3</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/11/19/backend/back-spring-config/" title="[Spring]Spring Boot Devtools 설정"><i class="post-icon gg-file-document"></i>[Spring]Spring Boot Devtools 설정</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2024/01/01/backend/back-spring-index/" title="[Spring]기본 인덱스"><i class="post-icon gg-file-document"></i>[Spring]기본 인덱스</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2024/01/01/backend/back-spring-troubleshooting/" title="[Spring]트러블슈팅"><i class="post-icon gg-file-document"></i>[Spring]트러블슈팅</a></li></ul></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/FrontEnd/">
          FrontEnd
        </a>
      <span class="tree-list-count">2</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/frond-end/fe-concepts/" title="프론트엔드 기본개념들"><i class="post-icon gg-file-document"></i>프론트엔드 기본개념들</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/frond-end/fe-javascript-index/" title="자바스크립트 코드스니펫"><i class="post-icon gg-file-document"></i>자바스크립트 코드스니펫</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/Infra/">
          Infra
        </a>
      <span class="tree-list-count">5</span><ul class="tree-list-children">
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/Infra/Config/">
          Config
        </a>
      <span class="tree-list-count">1</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2021/07/08/infra/conda-install/" title="Anaconda 시작시 기본설정"><i class="post-icon gg-file-document"></i>Anaconda 시작시 기본설정</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/Infra/git/">
          git
        </a>
      <span class="tree-list-count">4</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2021/07/17/infra/git/git-basic/" title="[Git]간단한 Git 명령어 및 용법 정리"><i class="post-icon gg-file-document"></i>[Git]간단한 Git 명령어 및 용법 정리</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2021/07/17/infra/git/git-commands/" title="[Git]기본적인 컨셉들"><i class="post-icon gg-file-document"></i>[Git]기본적인 컨셉들</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2021/08/02/infra/git/git-log/" title="[Git]commit, push 제외 자주쓰는 git 명령어들"><i class="post-icon gg-file-document"></i>[Git]commit, push 제외 자주쓰는 git 명령어들</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/infra/git/git-private-repo/" title="[Git]Private repository import 하기"><i class="post-icon gg-file-document"></i>[Git]Private repository import 하기</a></li></ul></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/Tools/">
          Tools
        </a>
      <span class="tree-list-count">4</span><ul class="tree-list-children">
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/Tools/etc/">
          etc
        </a>
      <span class="tree-list-count">1</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/12/03/tools/firefox/firefox-shortcut/" title="[Firefox]FireFox 단축키 정리하기"><i class="post-icon gg-file-document"></i>[Firefox]FireFox 단축키 정리하기</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/Tools/Neovim/">
          Neovim
        </a>
      <span class="tree-list-count">1</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/12/30/tools/nvim-keybinding/" title="[Neovim]NeoVim Keybinding"><i class="post-icon gg-file-document"></i>[Neovim]NeoVim Keybinding</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/Tools/Intellij/">
          Intellij
        </a>
      <span class="tree-list-count">2</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/12/06/tools/intellij/Intellij-shortcut/" title="[Intellij]Intellij 단축키 정리"><i class="post-icon gg-file-document"></i>[Intellij]Intellij 단축키 정리</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/12/30/tools/obsidian/obsidian-shortcut/" title="[Obsidian]Obsidian 커스텀 단축키 업데이트"><i class="post-icon gg-file-document"></i>[Obsidian]Obsidian 커스텀 단축키 업데이트</a></li></ul></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/Data-Engineering/">
          Data Engineering
        </a>
      <span class="tree-list-count">12</span><ul class="tree-list-children">
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/Data-Engineering/Linux/">
          Linux
        </a>
      <span class="tree-list-count">1</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2021/10/08/data-engineering/linux/DE-linux-commandline/" title="[linux]데이터 관련 프로젝트시 자주 사용하는 commandline 명령어 모음"><i class="post-icon gg-file-document"></i>[linux]데이터 관련 프로젝트시 자주 사용하는 commandline 명령어 모음</a></li></ul></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/Programming/">
          Programming
        </a>
      <span class="tree-list-count">12</span><ul class="tree-list-children">
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/Programming/R/">
          R
        </a>
      <span class="tree-list-count">1</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2021/03/02/programming/R-Programming-operators/" title="[R]특별한 R 연산자들(Binary Oerators)"><i class="post-icon gg-file-document"></i>[R]특별한 R 연산자들(Binary Oerators)</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/Programming/Java/">
          Java
        </a>
      <span class="tree-list-count">2</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/11/25/programming/java/Java-Action/" title="[Java]기본컨셉들"><i class="post-icon gg-file-document"></i>[Java]기본컨셉들</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/11/14/programming/java/Java-Basic/" title="[Java]기본컨셉들"><i class="post-icon gg-file-document"></i>[Java]기본컨셉들</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/Programming/Python/">
          Python
        </a>
      <span class="tree-list-count">2</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/programming/python/Python-Closure/" title="[Python]Closure에 대한 이해"><i class="post-icon gg-file-document"></i>[Python]Closure에 대한 이해</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/12/30/programming/python/Python-init_call/" title="[Python] init, call method"><i class="post-icon gg-file-document"></i>[Python] init, call method</a></li></ul></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/Preprocessing/">
          Preprocessing
        </a>
      <span class="tree-list-count">8</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/preprocessing/Preprocessing-dt-Scaler/" title="[Data Transformation]Feature Scaling의 이해"><i class="post-icon gg-file-document"></i>[Data Transformation]Feature Scaling의 이해</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/preprocessing/Preprocessing-numpy-basics/" title="[Python]numpy 연산과 활용법"><i class="post-icon gg-file-document"></i>[Python]numpy 연산과 활용법</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/preprocessing/Preprocessing-pandas-collection-to-df/" title="[pandas]기본자료형을 DataFrame으로 변환하기"><i class="post-icon gg-file-document"></i>[pandas]기본자료형을 DataFrame으로 변환하기</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/preprocessing/Preprocessing-pandas-remove_col/" title="[pandas]pandas의 특정 열 제외한 모든 컬럼 출력하기"><i class="post-icon gg-file-document"></i>[pandas]pandas의 특정 열 제외한 모든 컬럼 출력하기</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/preprocessing/Preprocessing-pandas_groupby/" title="[pandas]Pandas Groupby용법 간단히 정리"><i class="post-icon gg-file-document"></i>[pandas]Pandas Groupby용법 간단히 정리</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/preprocessing/Preprocessing-pandas_overview/" title="[pandas]Pandas를 활용한 데이터분석 시작하기"><i class="post-icon gg-file-document"></i>[pandas]Pandas를 활용한 데이터분석 시작하기</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/preprocessing/Preprocessing-pandas_tricks/" title="[pandas]pandas 함수와 기초용법들"><i class="post-icon gg-file-document"></i>[pandas]pandas 함수와 기초용법들</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/preprocessing/Preprocessing-sampling-imbalance-data/" title="[Sampling]Class Imbalance 다루기"><i class="post-icon gg-file-document"></i>[Sampling]Class Imbalance 다루기</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/Neural-Network/">
          Neural Network
        </a>
      <span class="tree-list-count">7</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2021/08/05/machine-learning/DL-RNN/" title="[Neural Network]Recurrent Neural Network"><i class="post-icon gg-file-document"></i>[Neural Network]Recurrent Neural Network</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2021/09/28/machine-learning/DL-backpropagation/" title="[Neural Network]역전파 알고리즘(backpropagation)"><i class="post-icon gg-file-document"></i>[Neural Network]역전파 알고리즘(backpropagation)</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2021/07/30/machine-learning/DL-hyperparameter/" title="[Neural Network]하이퍼파라미터"><i class="post-icon gg-file-document"></i>[Neural Network]하이퍼파라미터</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2021/07/15/machine-learning/DL-lossfunction/" title="[Deep Learning]Loss function"><i class="post-icon gg-file-document"></i>[Deep Learning]Loss function</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2021/07/10/machine-learning/DL-optimizer/" title="[Deep Learning]Optimizer"><i class="post-icon gg-file-document"></i>[Deep Learning]Optimizer</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2021/07/03/machine-learning/DL-perceptron/" title="[Neural Network]Perceptron의 이해"><i class="post-icon gg-file-document"></i>[Neural Network]Perceptron의 이해</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2021/08/02/machine-learning/DL-regularization/" title="[Deep Leearing] 학습 규제하기(Handling Overfitting)"><i class="post-icon gg-file-document"></i>[Deep Leearing] 학습 규제하기(Handling Overfitting)</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/Machine-Learning/">
          Machine Learning
        </a>
      <span class="tree-list-count">12</span><ul class="tree-list-children">
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/Machine-Learning/Supervised-Learning/">
          Supervised Learning
        </a>
      <span class="tree-list-count">1</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/machine-learning/ML-SP-SVM/" title="[SVM]서포트벡터머신의 이해"><i class="post-icon gg-file-document"></i>[SVM]서포트벡터머신의 이해</a></li></ul></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/NLP/">
          NLP
        </a>
      <span class="tree-list-count">2</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/machine-learning/NLP-NLU/" title="[NLP]NLU & QA task"><i class="post-icon gg-file-document"></i>[NLP]NLU & QA task</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2022/03/02/machine-learning/NLP-wordembedding/" title="[NLP]Word Embedding과 Text Classification"><i class="post-icon gg-file-document"></i>[NLP]Word Embedding과 Text Classification</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/Troubleshooting/">
          Troubleshooting
        </a>
      <span class="tree-list-count">3</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/troubleshooting/TS-R-lib-1/" title="[R]make: gfortran: No such file or directory 해결하기"><i class="post-icon gg-file-document"></i>[R]make: gfortran: No such file or directory 해결하기</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2021/12/01/troubleshooting/TS-SQL-ts-1/" title="[SQL]ERROR 3948 (42000): Loading local data is disabled; this must be enabled on both the client and server sides 해결하기"><i class="post-icon gg-file-document"></i>[SQL]ERROR 3948 (42000): Loading local data is disabled; this must be enabled on both the client and server sides 해결하기</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/troubleshooting/TS-linux-ts-1/" title="[Linux]zsh: corrupt history file 해결"><i class="post-icon gg-file-document"></i>[Linux]zsh: corrupt history file 해결</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/Statistics/">
          Statistics
        </a>
      <span class="tree-list-count">5</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/11/26/statistics/Statistics-GLM-test/" title="[GLM]선형모델과 비선형 모델의 차이"><i class="post-icon gg-file-document"></i>[GLM]선형모델과 비선형 모델의 차이</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/statistics/Statistics-Math-derivatives/" title="[Math]미분 기초개념"><i class="post-icon gg-file-document"></i>[Math]미분 기초개념</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/statistics/Statistics-Prob-binary-dist/" title="[Probability]이항분포의 이해"><i class="post-icon gg-file-document"></i>[Probability]이항분포의 이해</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/statistics/Statistics-Prob-chi-square-dist/" title="[Probability]Python을 활용한 카이스퀘어 검정 구현"><i class="post-icon gg-file-document"></i>[Probability]Python을 활용한 카이스퀘어 검정 구현</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2021/08/10/statistics/Statistics-Prob-multinomial-dist/" title="[Probability]numpy와 scipy로 다항분포 간단하게 구현하기"><i class="post-icon gg-file-document"></i>[Probability]numpy와 scipy로 다항분포 간단하게 구현하기</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/programming/">
          programming
        </a>
      <span class="tree-list-count">1</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/11/12/programming/oop/" title=""><i class="post-icon gg-file-document"></i></a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/ariflow/">
          ariflow
        </a>
      <span class="tree-list-count">1</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/12/23/data-engineering/airflow/airflow-index/" title="[airflow]Index"><i class="post-icon gg-file-document"></i>[airflow]Index</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/machine-learning/">
          machine-learning
        </a>
      <span class="tree-list-count">23</span><ul class="tree-list-children">
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/machine-learning/notebook/">
          notebook
        </a>
      <span class="tree-list-count">23</span><ul class="tree-list-children">
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/machine-learning/notebook/machine-learning/">
          machine-learning
        </a>
      <span class="tree-list-count">9</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/machine-learning/notebook/machine-learning/3_bias_variance/" title=""><i class="post-icon gg-file-document"></i></a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/machine-learning/notebook/machine-learning/3_distance_based_model/" title=""><i class="post-icon gg-file-document"></i></a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/machine-learning/notebook/machine-learning/7_model_pipeline/" title=""><i class="post-icon gg-file-document"></i></a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/12/09/machine-learning/notebook/machine-learning/design_pattern/" title=""><i class="post-icon gg-file-document"></i></a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/machine-learning/notebook/machine-learning/template/" title=""><i class="post-icon gg-file-document"></i></a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/machine-learning/notebook/machine-learning/tensorflow/" title=""><i class="post-icon gg-file-document"></i></a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/machine-learning/notebook/machine-learning/unsorted/" title=""><i class="post-icon gg-file-document"></i></a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/machine-learning/notebook/machine-learning/unsupervised_learning/" title=""><i class="post-icon gg-file-document"></i></a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/machine-learning/notebook/machine-learning/xai/" title=""><i class="post-icon gg-file-document"></i></a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/machine-learning/notebook/assets/">
          assets
        </a>
      <span class="tree-list-count">1</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/machine-learning/notebook/assets/References/" title=""><i class="post-icon gg-file-document"></i></a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/machine-learning/notebook/preprocessing/">
          preprocessing
        </a>
      <span class="tree-list-count">2</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/machine-learning/notebook/preprocessing/Preprocessing/" title=""><i class="post-icon gg-file-document"></i></a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/machine-learning/notebook/preprocessing/deal/" title=""><i class="post-icon gg-file-document"></i></a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/machine-learning/notebook/statitsics/">
          statitsics
        </a>
      <span class="tree-list-count">4</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/machine-learning/notebook/statitsics/1-probability/" title=""><i class="post-icon gg-file-document"></i></a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/machine-learning/notebook/statitsics/3-parameter-estimation/" title=""><i class="post-icon gg-file-document"></i></a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/machine-learning/notebook/statitsics/glm/" title=""><i class="post-icon gg-file-document"></i></a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/machine-learning/notebook/statitsics/survival-analisis/" title=""><i class="post-icon gg-file-document"></i></a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/machine-learning/notebook/timeseries/">
          timeseries
        </a>
      <span class="tree-list-count">1</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/machine-learning/notebook/timeseries/TimeSeries/" title=""><i class="post-icon gg-file-document"></i></a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/machine-learning/notebook/visualization/">
          visualization
        </a>
      <span class="tree-list-count">4</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/machine-learning/notebook/visualization/Visualization/" title=""><i class="post-icon gg-file-document"></i></a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/10/28/machine-learning/notebook/visualization/mpl-seaborn/" title=""><i class="post-icon gg-file-document"></i></a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/12/09/machine-learning/notebook/visualization/olap/" title=""><i class="post-icon gg-file-document"></i></a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/12/09/machine-learning/notebook/visualization/plotly/" title=""><i class="post-icon gg-file-document"></i></a></li></ul></li></ul></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/frond-end/">
          frond-end
        </a>
      <span class="tree-list-count">1</span><ul class="tree-list-children">
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/frond-end/react/">
          react
        </a>
      <span class="tree-list-count">1</span><ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/2023/12/16/frond-end/react/react-index/" title=""><i class="post-icon gg-file-document"></i></a></li></ul></li></ul></li></ul>
        <div id="widget-tree-button">
          <i class="gg-chevron-right"></i>
        </div>
      </div><!-- hexo injector body_end end --></body>
</html>
